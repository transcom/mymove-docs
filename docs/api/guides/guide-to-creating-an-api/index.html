<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-api/guides/guide-to-creating-an-api">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Creating an API | MilMove Developer Portal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://transcom.github.io/mymove-docs/docs/api/guides/guide-to-creating-an-api"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Creating an API | MilMove Developer Portal"><meta data-rh="true" name="description" content="These are the various steps that are involved in creating a new endpoint."><meta data-rh="true" property="og:description" content="These are the various steps that are involved in creating a new endpoint."><link data-rh="true" rel="icon" href="/mymove-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://transcom.github.io/mymove-docs/docs/api/guides/guide-to-creating-an-api"><link data-rh="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/api/guides/guide-to-creating-an-api" hreflang="en"><link data-rh="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/api/guides/guide-to-creating-an-api" hreflang="x-default"><link rel="stylesheet" href="/mymove-docs/assets/css/styles.9e3c44d1.css">
<link rel="preload" href="/mymove-docs/assets/js/runtime~main.0dac6be3.js" as="script">
<link rel="preload" href="/mymove-docs/assets/js/main.52178997.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mymove-docs/"><div class="navbar__logo"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">MilMove Documentation</b></a><a class="navbar__item navbar__link" href="/mymove-docs/docs/getting-started/">Getting Started</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/adrs">ADRs</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/frontend">Frontend</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/backend">Backend</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/integrations">Integrations</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mymove-docs/docs/api">API</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/tools">Tools</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/help/index">Help</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">mymove<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mymove-docs/docs/api">MilMove API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mymove-docs/api/admin">Swagger Documentation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://github.com/transcom/prime_api_deliverable" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Docs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/mymove-docs/docs/api/guides/api-programming-guide">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/api/guides/api-programming-guide">API Programming Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/api/guides/api-errors">API Errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/api/guides/api-style-guide">API Style Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/api/guides/guide-to-creating-an-endpoint">Creating an Endpoint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mymove-docs/docs/api/guides/guide-to-creating-an-api">Creating an API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/api/guides/how-to-deprecate-endpoints">How to Deprecate an API Endpoint</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mymove-docs/docs/api/testing/acceptance-testing-prime-api-endpoints">Testing</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/mymove-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Creating an API</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Creating an API</h1><h6 class="anchor anchorWithStickyNavbar_LWe7" id="these-are-the-various-steps-that-are-involved-in-creating-a-new-endpoint">These are the various steps that are involved in creating a new endpoint.<a href="#these-are-the-various-steps-that-are-involved-in-creating-a-new-endpoint" class="hash-link" aria-label="Direct link to These are the various steps that are involved in creating a new endpoint." title="Direct link to These are the various steps that are involved in creating a new endpoint.">​</a></h6><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>This is assumed you are creating a new API router on an existing server, this documentation will not cover how to create a new server. </p></div></div><p>Prior to creating a new API, we must first implement the swagger definition of said new API. We are using Swagger 2.0, which is <a href="https://swagger.io/specification/v2/" target="_blank" rel="noopener noreferrer">OpenAPI</a>, a specification we use to format our RESTful APIs and provide a template for us to communicate the information in our API.
Always start with swagger. This step creates your API&#x27;s endpoint definitions and generates the files and helper functions you will need to create your endpoint. More specifically, swagger converts JSON user input into generated Go types.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-new-api-yaml">Creating a new API yaml<a href="#creating-a-new-api-yaml" class="hash-link" aria-label="Direct link to Creating a new API yaml" title="Direct link to Creating a new API yaml">​</a></h2><p>All new API require a new yaml file to be added in <code>mymove/swagger-def</code>. This directory holds many different specs and definitions as they get reused throughout the application.
You will notice that there is also a <code>mymove/swagger</code> folder which holds what looks to be a copy of <code>swagger-def</code>, please do not edit within this folder. The <code>swagger</code> folder
holds the generated specs to be used within the backend of the codebase.
After we have a base <code>.yaml</code> file for our new API and maybe even some tags and paths defined, we will generate Swagger and the new API definitions and specs will generated and be placed inside the <code>swagger</code> folder.</p><p>First, create a your new API.yaml file under <code>mymove/swagger-def</code>, similar to how <code>admin.yaml</code>, <code>prime.yaml</code>, <code>support.yaml</code>, etc. are present. Populate your new <code>.yaml</code> file with this template info:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">swagger: &#x27;2.0&#x27;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">info:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  title: MilMove ${API_NAME} API</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  version: 1.0.0</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  license:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    name: MIT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    url: &#x27;https://opensource.org/licenses/MIT&#x27;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  contact:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    email: milmove-developers@caci.com</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  description:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    ${INSERT_DESCRIPTION}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">basePath: ${API_NAME}/v1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">consumes:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  - application/json</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">produces:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  - application/json</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">schemes:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  - ${http or https}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Populate <code>${API_NAME}</code> with the name of your new API</li><li>Populate <code>${INSERT_DESCRIPTION}</code> with a description of your new API, or conversely create a new markdown file and reference it with <code>$ref: info/${API_NAME}_description.md</code></li><li>Populate <code>${http or https}</code><ul><li>Populate with <code>http</code> for testing and development, such as the Support API</li><li>Populate with <code>https</code> for production environments where sensitive information may transmit over TLS. Note that the server and routing configs will handle the TLS path routing and security.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-new-api-html">Creating a new API html<a href="#creating-a-new-api-html" class="hash-link" aria-label="Direct link to Creating a new API html" title="Direct link to Creating a new API html">​</a></h2><p>We will also need an HTML file for the Swagger-UI. To do this as easy as possible, navigate to <code>mymove/public/swagger-ui</code>, where you will find existing HTML files for the APIs such as <code>prime.html</code> and <code>support.html</code>.
Since these HTML files only differ by one line, we will simply duplicate one and modify said line. Create a new copy of an existing HTML API file, such as <code>prime.html</code>. Give this new file a name of <code>${API_NAME}.html</code>, and then near line 100, where the url attribute is passed into the <code>SwaggerUIBundle</code> function, adjust the existing API name to be your new one. For example, replacing <code>url: &quot;/prime/v1/swagger.yaml&quot;</code> with <code>url: &quot;/apiNameHere/v1/swagger.yaml&quot;</code>. Leave this file for now
as we will come back later when mounting the API handler for Swagger UI.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="generating-swagger-code-for-your-api">Generating swagger code for your API<a href="#generating-swagger-code-for-your-api" class="hash-link" aria-label="Direct link to Generating swagger code for your API" title="Direct link to Generating swagger code for your API">​</a></h2><p>Once your Swagger API <code>.yaml</code> files have been created under <code>swagger-def</code>, we need to make sure they can be generated for use by our backend. To do this, we need to modify the <code>gen-server</code> script found under <code>mymove/scripts/gen-server</code>.</p><p>Within this file you will see two sections at the bottom to execute the bash script functions <code>generate_server</code> and <code>generate_client</code>. Please add a new execution line under these two sections for your new API.</p><p>Example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain"># Generate Server Code</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">...</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">generate_server swagger/${API_FILENAME}.yaml    ${API_NAME}messages    ${API_NAME}api    ${API_NAME}operations</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"># Generate Client Code</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">...</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">generate_client swagger/${API_FILENAME}.yaml ${API_NAME}messages ${API_NAME}client</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once you have added the new execution lines to the bash script, when the <code>gen-server</code> script executes, it will generate the new swagger server and client code for your API. Feel free to execute this script manually yourself or run <code>make server_run</code> within the MyMove repository.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-your-api-handler">Creating your API handler<a href="#creating-your-api-handler" class="hash-link" aria-label="Direct link to Creating your API handler" title="Direct link to Creating your API handler">​</a></h2><p>Now that we have a basic swagger definition for our API and the corresponding Swagger code generated, we are now able to create the API handler and mount it.</p><p>Navigate to <code>mymove/pkg/handlers</code> and create a new folder called <code>${API_NAME}api</code>, similar to <code>primeapi</code>, <code>ghcapi</code>, etc. Within this folder create a new file called <code>api.go</code>. Template your file like so:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">package ${API_NAME}api</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">import (</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;log&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;github.com/go-openapi/loads&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;github.com/transcom/mymove/pkg/gen/${API_NAME}api&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    ${API_NAME}ops &quot;github.com/transcom/mymove/pkg/gen/${API_NAME}api/${API_NAME}operations&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;github.com/transcom/mymove/pkg/handlers&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">func New${API_NAME}API(handlerConfig handlers.HandlerConfig) *${API_NAME}ops.MymoveAPI {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    ${API_NAME}Spec, err := loads.Analyzed(${API_NAME}api.SwaggerJSON, &quot;&quot;)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    if err != nil {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        log.Fatalln(err)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    ${API_NAME}API := ${API_NAME}ops.NewMymoveAPI(${API_NAME}Spec)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    ${API_NAME}API.ServeError = handlers.ServeCustomError</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    return ${API_NAME}API</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This file will receive some test coverage after we add the API to the &quot;routing&quot; portion of our backend. Now that there is a dedicated handler func to instantiate your new API, we need to decide which server it will be attached to. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="milmove-servers">MilMove servers<a href="#milmove-servers" class="hash-link" aria-label="Direct link to MilMove servers" title="Direct link to MilMove servers">​</a></h2><p>There are four MilMove servers</p><ul><li>health</li><li>no-tls</li><li>tls</li><li>mutual-tls</li></ul><p>These services are launches inside the <code>serveFunction</code> within <code>mymove/cmd/milmove/serve.go</code>.</p><p><strong>Health</strong>
The health server is a dedicated server only for health checks and the health API.</p><p><strong>no-tls</strong>
The no-tls server is typically only utilized during development, this facilitates our client and office API calls.</p><p><strong>tls</strong>
The tls server is the production server for MilMove client and office API calls</p><p><strong>mutual-tls</strong>
The mutual tls server is our production server for our public API. This is where the Prime and PPTAS APIs are hosted. This server also runs
during the development environment, but is typically proxied to from the frontend on port 3000 under <code>primelocal:3000</code>. If you create your API
on the mutual-tls server (Prime router is the generic name), then you will not be able to access it under <code>primelocal:3000</code> unless you add it to the proxy at <code>mymove/src/setupProxy.js</code>. More details further along.</p><p><strong>Which to choose</strong>
You are going to append your new API path to one of these servers. Most likely if you are reading this then it is not an endpoint specific to the Office, Customer, or Admin APIs, and rather a new API entirely for
another Department of Defense (DOD) agency. If you are looking to create a new API as an expansion upon internal MyMove operations, then please resort to no-tls or tls. If you are
opening access and creating a new API for a third-party agency, then you will want to use the mutual-tls server for extra security.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mounting-your-api-to-an-existing-server">Mounting your API to an existing server<a href="#mounting-your-api-to-an-existing-server" class="hash-link" aria-label="Direct link to Mounting your API to an existing server" title="Direct link to Mounting your API to an existing server">​</a></h2><p>At the time of this writing, all of the servers share the same routing config, where a HostRouter then routes incoming requests to the corresponding sub-router, appending additional layers of middleware security accordingly. Please
attempt to pull up the <code>InitRouting</code> func within <code>mymove/pkg/handlers/routing/routing_init.go</code>. Within this file you will find the heart of our routing configuration. Within this func you will find the routers being created within the server.
All servers call this func and depending on the domain name, will be routed to the correct router accordingly. </p><p>Currently, the five routers are as follows</p><ul><li>Mil Router<ul><li>no-tls</li><li>tls server</li></ul></li><li>Office Router<ul><li>no-tls server</li><li>tls server</li></ul></li><li>Admin Router<ul><li>mutual-tls server</li><li>proxied during development</li></ul></li><li>Prime Router<ul><li>mutual-tls server</li><li>proxied under &quot;Prime Simulator&quot; during development</li></ul></li><li>Health Router<ul><li>health server</li></ul></li></ul><p>The proxy will be covered further along. Please navigate to the function that creates the desired router you want to host your API on. Creating a new router should only ever be done if you are standing up a new server.</p><p>This example will utilize the Prime router. The Prime router is stood up under the <code>newPrimeRouter</code> func, and currently looks like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">// This &quot;Prime&quot; router is really just the &quot;API&quot; router for MilMove.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">// It was initially just named under &quot;Prime&quot; as it was the only use of the router</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">func newPrimeRouter(appCtx appcontext.AppContext, redisPool *redis.Pool,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    routingConfig *Config, telemetryConfig *telemetry.Config, serverName string) chi.Router {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    site := newBaseRouter(appCtx, routingConfig, telemetryConfig, serverName)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    mountHealthRoute(appCtx, redisPool, routingConfig, site)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    mountPrimeAPI(appCtx, routingConfig, site)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    mountSupportAPI(appCtx, routingConfig, site)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    mountTestharnessAPI(appCtx, routingConfig, site)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    mountPPTASAPI(appCtx, routingConfig, site)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    return site</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This func, <code>newPrimeRouter</code>, creates a <a href="https://github.com/go-chi/chi" target="_blank" rel="noopener noreferrer">chi router</a> with shared middleware with the <code>newBaseRouter</code> call. This means that with the chi router being created with shared middleware,
we are now able to mount paths (APIs) to the Prime router, inheriting basic middleware and then when mounting additional paths, additional middleware can be added if desired.</p><p>We are going to want to create a new function called <code>mount${API_NAME}</code>, based on the following template:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">// Please note that this is a template that will need additional customization and security per requirements.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">// For example, this mounting does not conditionally serve from within the routing config. That is a</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">// customization you will want to introduce.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">func mount${API_NAME}API(appCtx appcontext.AppContext, routingConfig *Config, site chi.Router) {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        site.Route(&quot;/${API_NAME}/v1&quot;, func(r chi.Router) {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            r.Method(</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                &quot;GET&quot;,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                &quot;/swagger.yaml&quot;, // Here is the endpoint we are going to hit to make sure our API is mounted and reachable</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                handlers.NewFileHandler(routingConfig.FileSystem,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    routingConfig.${API_NAME}SwaggerPath))</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            if routingConfig.ServeSwaggerUI { // Conditionally loading the SwaggerUI just like the other APIs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                r.Method(&quot;GET&quot;, &quot;/docs&quot;,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    handlers.NewFileHandler(routingConfig.FileSystem,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                        path.Join(routingConfig.BuildRoot, &quot;swagger-ui&quot;, &quot;${API_NAME}.html&quot;))) // Here&#x27;s that HTML file we made earlier</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            } else {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                r.Method(&quot;GET&quot;, &quot;/docs&quot;, http.NotFoundHandler())</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            api := ${API_NAME}api.New${API_NAME}API(routingConfig.HandlerConfig)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            tracingMiddleware := middleware.OpenAPITracing(api)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            r.Mount(&quot;/&quot;, api.Serve(tracingMiddleware))</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        })</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, add this mounting func to the router you want to branch off, in our example we used the Prime router.</p><p>Example</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    mountSupportAPI(appCtx, routingConfig, site)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    mountTestharnessAPI(appCtx, routingConfig, site)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    mountPPTASAPI(appCtx, routingConfig, site)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  mount${API_NAME}(appCtx, routingConfig, site) // Order does not matter</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    return site</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-proxy-for-your-api">Creating a proxy for your API<a href="#creating-a-proxy-for-your-api" class="hash-link" aria-label="Direct link to Creating a proxy for your API" title="Direct link to Creating a proxy for your API">​</a></h2><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Just because you don&#x27;t proxy your API doesn&#x27;t mean you can&#x27;t reach it. Typically, this is only really even necessary for mutual-tls APIs, but it is not required.
For example, if you are hosting on the Prime then it will be immediately mounted and hosted on the real mutual-tls server (locally) at domain <code>primelocal</code>, port <code>9443</code>.
Our documentation leads most to utilize <code>primelocal:3000</code>, this is a proxy URL. This proxy URL is only accessible while the frontend is running.</p></div></div><p>We utilize a frontend proxy for our API that can be utilized during testing to make it easy to access the HTTPS api via an HTTP channel. Simply navigate to <code>mymove/src/setupProxy.js</code>
and create a new line, adding a new proxy middleware to handle routes to <code>/${API_NAME}</code> with the target of <code>milmovelocal</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-your-api-test">Creating your API test<a href="#creating-your-api-test" class="hash-link" aria-label="Direct link to Creating your API test" title="Direct link to Creating your API test">​</a></h2><p>We are going to want to create a swagger.yaml GET request test for the new API. Routing tests can be found under <code>mymove/pkg/handlers/routing</code>. Create a new folder called <code>${API_NAME}_test</code>.
Within this folder, we want to create a new test suite for routing tests and your API. Create a file called <code>${API_NAME}_test.go</code>.</p><p>Populate <code>${API_NAME}_test.go</code> like so:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">package ${API_NAME}api_test</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">import (</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;testing&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;github.com/stretchr/testify/suite&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;github.com/transcom/mymove/pkg/handlers/routing&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">type ${API_NAME}APISuite struct {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    routing.BaseRoutingSuite</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">func Test${API_NAME}Suite(t *testing.T) {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    hs := &amp;${API_NAME}APISuite{</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        routing.NewBaseRoutingSuite(),</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite.Run(t, hs)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    hs.PopTestSuite.TearDown()</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This creates our test suite so we can write a test for the <code>.yaml</code> file. To make a test for your <code>swagger.yaml</code> GET request, create a file called <code>swagger_test.go</code>.</p><p>Populate <code>swagger_test.go</code> like so:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">package ${API_NAME}api_test</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">import (</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;io&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;net/http&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;net/http/httptest&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    &quot;github.com/transcom/mymove/pkg/factory&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">func (suite *${API_NAME}APISuite) TestSwaggerYaml() {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    routingConfig := suite.RoutingConfig()</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    routingConfig.${API_NAME}SwaggerPath = &quot;foo/bar/baz&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    swaggerContent := &quot;some\nswagger\ncontent\n&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite.CreateFileWithContent(routingConfig.${API_NAME}SwaggerPath, swaggerContent)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    siteHandler := suite.SetupCustomSiteHandler(routingConfig)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // Adjust the request requirements per server or API needs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    cert := factory.BuildPrimeClientCert(suite.DB())</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    req := suite.NewAuthenticatedPrimeRequest(&quot;GET&quot;, &quot;/${API_NAME}/v1/swagger.yaml&quot;, nil, cert)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    rr := httptest.NewRecorder()</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    siteHandler.ServeHTTP(rr, req)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite.Equal(http.StatusOK, rr.Code)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    actualData, err := io.ReadAll(rr.Body)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite.NoError(err)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite.Equal(swaggerContent, string(actualData))</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>swagger_test.go</code> file should provide a test that should pass and successfully access your <code>swagger.yaml</code> file.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="manually-testing-your-api">Manually testing your API<a href="#manually-testing-your-api" class="hash-link" aria-label="Direct link to Manually testing your API" title="Direct link to Manually testing your API">​</a></h2><p>Please only conduct manual testing after your testing suite has been confirmed to pass. It is better practice to troubleshoot and test within the files themselves rather than manually testing and modifying code.</p><p>Ensure all files are saved, and then turn on both your client and server. It is important to have both in case you are going to use a proxy endpoint such as <code>primelocal:3000</code>. Now,
as we didn&#x27;t introduce any additional middleware security, we only need to satisfy the base router&#x27;s middleware. Typically this would include creating an office session if
branched off the GHC/Office or Admin API, or having your certs already setup for something such as the mutual-tls Prime server.  If you do not know how to do this, please see
the <a href="/mymove-docs/docs/tools/postman/setting-up-postman">Setting up Postman</a> article.</p><p>With your client and server running, please utilize an API tool such as Postman to test a GET request to the <code>.yaml</code> file that was explicitly mounted inside the mount${API_NAME} function. If
all went well, you should successfully be able to use a GET request to hit the path of your API, meaning you have created and mounted your API within MilMove. As our API architecture
is subject to change, please reach out to the MilMove developers for any additional assistance or troubleshooting during this process.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="related">Related:<a href="#related" class="hash-link" aria-label="Direct link to Related:" title="Direct link to Related:">​</a></h2><ul><li><a href="/mymove-docs/docs/backend/testing/acceptance-testing-payment-requests">Acceptance testing payment requests</a></li><li><a href="/mymove-docs/docs/frontend/guides/access-swagger-endpoints-from-react">How To Call Swagger Endpoints from React</a></li><li><a href="/mymove-docs/docs/api/testing/acceptance-testing-prime-api-endpoints">Acceptance Testing Prime API</a></li><li><a href="/mymove-docs/docs/api/guides/how-to-deprecate-endpoints">How to Deprecate an API Endpoint</a></li><li><a href="/mymove-docs/docs/api/testing/how-to-test-the-prime-api">How to Test the Prime API</a></li><li><a href="/mymove-docs/docs/api/guides/guide-to-creating-an-endpoint">Creating an Endpoint</a></li><li><a href="/mymove-docs/docs/api/guides/guide-to-creating-an-api">Creating an API</a></li><li><a href="https://goswagger.io/tutorial/todo-list.html" target="_blank" rel="noopener noreferrer">Swagger tutorial</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/transcom/mymove-docs/edit/main/docs/api/guides/guide-to-creating-an-api.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/mymove-docs/docs/api/guides/guide-to-creating-an-endpoint"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Creating an Endpoint</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mymove-docs/docs/api/guides/how-to-deprecate-endpoints"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How to Deprecate an API Endpoint</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-a-new-api-yaml" class="table-of-contents__link toc-highlight">Creating a new API yaml</a></li><li><a href="#creating-a-new-api-html" class="table-of-contents__link toc-highlight">Creating a new API html</a></li><li><a href="#generating-swagger-code-for-your-api" class="table-of-contents__link toc-highlight">Generating swagger code for your API</a></li><li><a href="#creating-your-api-handler" class="table-of-contents__link toc-highlight">Creating your API handler</a></li><li><a href="#milmove-servers" class="table-of-contents__link toc-highlight">MilMove servers</a></li><li><a href="#mounting-your-api-to-an-existing-server" class="table-of-contents__link toc-highlight">Mounting your API to an existing server</a></li><li><a href="#creating-a-proxy-for-your-api" class="table-of-contents__link toc-highlight">Creating a proxy for your API</a></li><li><a href="#creating-your-api-test" class="table-of-contents__link toc-highlight">Creating your API test</a></li><li><a href="#manually-testing-your-api" class="table-of-contents__link toc-highlight">Manually testing your API</a></li><li><a href="#related" class="table-of-contents__link toc-highlight">Related:</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/adrs">Architecture Decision Records</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/frontend">Frontend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/backend">Backend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/api">API</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/tools">Tools</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/transcom/mymove-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">MilMove Documentation GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="footer__link-item">MilMove GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://6130eb5cde15830007fdf57b--docusaurus-2.netlify.app/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus Official Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright 2024  U.S. Federal Government.</div></div></div></footer></div>
<script src="/mymove-docs/assets/js/runtime~main.0dac6be3.js"></script>
<script src="/mymove-docs/assets/js/main.52178997.js"></script>
</body>
</html>