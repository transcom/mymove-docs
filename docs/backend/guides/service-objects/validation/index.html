<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-backend/guides/service-objects/validation">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Validation | MilMove Developer Portal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://transcom.github.io/mymove-docs/docs/backend/guides/service-objects/validation"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Validation | MilMove Developer Portal"><meta data-rh="true" name="description" content="We have to thoroughly validate user input to ensure it complies with our business rules for any mutations to data. To"><meta data-rh="true" property="og:description" content="We have to thoroughly validate user input to ensure it complies with our business rules for any mutations to data. To"><link data-rh="true" rel="icon" href="/mymove-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://transcom.github.io/mymove-docs/docs/backend/guides/service-objects/validation"><link data-rh="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/backend/guides/service-objects/validation" hreflang="en"><link data-rh="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/backend/guides/service-objects/validation" hreflang="x-default"><link rel="stylesheet" href="/mymove-docs/assets/css/styles.65849403.css">
<link rel="preload" href="/mymove-docs/assets/js/runtime~main.cb78340e.js" as="script">
<link rel="preload" href="/mymove-docs/assets/js/main.70764974.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mymove-docs/"><div class="navbar__logo"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">MilMove Documentation</b></a><a class="navbar__item navbar__link" href="/mymove-docs/docs/about/">About</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/adrs">ADRs</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/frontend">Frontend</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mymove-docs/docs/backend">Backend</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/integrations">Integrations</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/api">API</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/tools">Tools</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/help/index">Help</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">mymove<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mymove-docs/docs/backend">MilMove Backend</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mymove-docs/docs/backend/testing/acceptance-testing-syncada-edi-invoicing">Testing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/mymove-docs/docs/backend/guides/service-objects/overview">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/mymove-docs/docs/backend/guides/service-objects/overview">Service Objects</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/service-objects/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/service-objects/getting-started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/service-objects/structure">Structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/service-objects/set-up-service-subpackage-and-interface">Set Up Service Subpackage and Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mymove-docs/docs/backend/guides/service-objects/validation">Validation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/service-objects/implementation">Implementation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/service-objects/usage">Usage</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/backend-structure">Backend Structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/tariff400ng_items-update-data">Adding ShipmentLineItem records to the 400ng table (tariff400ng_items)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/database">Database Guides</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/feature-flags-in-the-app">Feature flags in the app</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/mymove-docs/docs/backend/guides/ghc/ghc-invoicing">Global Household Goods Contract</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/mymove-docs/docs/backend/guides/how-to/add-an-event-trigger">How-to guides</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/troubleshoot-gex-connection">Troubleshoot GEX Connection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/tariff400ng-yearly-import">Importing tariff400ng data for the year</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/troubleshoot-precommit-hook-failures">Precommit Hooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/route-planner">Route Planner Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/session-management">Session management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/roles-and-permissions">Roles and Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/switching-over-to-nix">Switching over to Nix</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/golang-time">Time in Golang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/golang-loops">Loop Iteration in Golang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/tspp-data-creation">Turning TDL scores and TSP discounts into transportation service provider performances</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/use-optimistic-locking">What Is Optimistic Locking?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/zip-code-to-rate-area-mappings">Zip code to Rate area mappings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/wip-server-side-validation">WIP server-side validation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/debugging-sql-tests">Debugging SQL Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/guide-to-history-and-audit-logging">History and Audit Logging Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/open-telemetry">Open Telemetry</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/mymove-docs/docs/backend/guides/environment_variables/">Environment Variables</a><button aria-label="Toggle the collapsible sidebar category &#x27;Environment Variables&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/golang-guide">Golang Programming Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/understanding-milmove-routing">Understanding MilMove Routing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/use-stateless-services-with-app-context">AppContext: how and when to use it</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mymove-docs/docs/backend/setup/configure-postico-or-tableplus-to-connect-to-mymove-db">Setup</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/mymove-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Guides</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Service Objects</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Validation</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Validation</h1><p>We have to thoroughly validate user input to ensure it complies with our business rules for any mutations to data. To
encourage development of minimal, modular functions to check each rule, we have developed a validation pattern that
we can use consistently throughout our service objects. We have also designed it to easily change which rules are
applied based on the kind of user performing the action.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-pattern">The Pattern<a href="#the-pattern" class="hash-link" aria-label="Direct link to The Pattern" title="Direct link to The Pattern">​</a></h2><p>As mentioned in the section on <a href="/mymove-docs/docs/backend/guides/service-objects/structure#service-object-subpackage-structure">Service Object Subpackage Structure</a>,
our validation pattern revolves around using the files <code>rules.go</code> and <code>validation.go</code>.</p><p><code>validation.go</code> contains the machinery that executes our validation in this service. It is almost entirely functional,
and will generally look similar in most services. A lot of this code is boilerplate.</p><p><code>rules.go</code> contains our business logic. This is where we will write the functions that check each of our distinct
business rules for the object. They should be able to be called independently of each other. As business rules
change, this should likely be the main file that has to change, unless dependencies for validation change, but that
will be covered later.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementing-the-pattern">Implementing the Pattern<a href="#implementing-the-pattern" class="hash-link" aria-label="Direct link to Implementing the Pattern" title="Direct link to Implementing the Pattern">​</a></h2><p>First things first, you&#x27;ll need to identify some business rules or utilities that you&#x27;d like to implement.
Common checks will verify if the related move is available to the Prime contractor, if the ID/foreign key values on the
base object have been manipulated, if circumstantially required fields have been filled out, and so on.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Advanced Golang</div><div class="admonitionContent_S0QG"><p>The validation pattern documented here makes use of some advanced Go patterns. If you&#x27;re struggling with the syntax or
would like more context on what is happening, you can look at the <a href="#resources">resources section</a> for helpful<br>
<!-- -->explanations and examples.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="validationgo"><code>validation.go</code><a href="#validationgo" class="hash-link" aria-label="Direct link to validationgo" title="Direct link to validationgo">​</a></h3><p>We&#x27;ll start with creating the <code>validation.go</code> and <code>validation_test.go</code> files. In <code>validation.go</code>, we&#x27;ll set up our
validator types and write the base function that handles running our checks on the data.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">mymove/</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">├── pkg/</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">│   ├── services/</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">│   │   ├── ...</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">│   │   ├── pet/</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">│   │   │   ├── pet_service_test.go</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">│   │   │   ├── validation.go       &lt;- new file</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">│   │   │   ├── validation_test.go  &lt;- new file</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">│   │   ├── ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="validator-interface-and-the-validate-function"><code>validator</code> interface and the <code>Validate</code> function<a href="#validator-interface-and-the-validate-function" class="hash-link" aria-label="Direct link to validator-interface-and-the-validate-function" title="Direct link to validator-interface-and-the-validate-function">​</a></h4><p>Now we&#x27;ll define an interface type that all of our validators will implement. This type will be private to our
service package and have one method, <code>Validate()</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/validation.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// petValidator defines the interface for checking business rules for a pet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token plain"> petValidator </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Based on our general Go standards, we know this function (like many other functions) will take in the <code>AppContext</code>
as its first argument. Since the action is &quot;validate,&quot; it also makes sense that it would return an error. But what
else do we need?</p><p>The parameters of <code>Validate()</code> should include <strong>all model types</strong> that you will need to validate your business rules.
This will change on a case-by-case basis, but, at a minimum, you will generally include your subject model type.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="variations-of-validate-signature">Variations of <code>Validate</code> Signature<a href="#variations-of-validate-signature" class="hash-link" aria-label="Direct link to variations-of-validate-signature" title="Direct link to variations-of-validate-signature">​</a></h5><p>Since we&#x27;re creating service objects for creating and updating pets, we know we&#x27;ll need an argument that is of type
<code>models.Pet</code>. Unfortunately, we don&#x27;t have a set standard for how that argument should be used, nor how to handle
the updates. We&#x27;ll talk about a couple of the ways you&#x27;ll find in existing code, but then pick one to use for the
purposes of these docs.</p><ol><li><p>Use <code>new</code> and <code>original</code> models. Looks something like this:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/validation.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// petValidator defines the interface for checking business rules for a pet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token plain"> petValidator </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">// Validate The newPet is assumed to be required, so that is a value type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">// The originalPet is optional, so it&#x27;s a pointer type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For this pattern, the following explains what <code>newPet</code> (a.k.a. the <code>base</code>) and <code>originalPet</code> would contain for
<code>create</code> vs <code>update</code>:</p><ol><li><p><code>create</code>: <code>newPet</code> would contain the information for the new <code>Pet</code>, while <code>originalPet</code> would be <code>nil</code>.</p></li><li><p><code>update</code>: <code>newPet</code> would contain the requested <em>final</em> version of the <code>Pet</code>, while <code>originalPet</code> would
contain the original version of the pet. The <em>final</em> version of the <code>Pet</code> is the version that would be
saved to the database, meaning the original <code>Pet</code> with the requested changes made to it already, in other words,
a merged version of the <code>Pet</code>.</p></li></ol><p>Pros:</p><ul><li>Validating the version of the model that would be saved to the database, so there&#x27;s less of a chance for there
to be invalid data saved.</li></ul><p>Cons:</p><ul><li>Can&#x27;t easily see what changes are without comparing the <code>new</code> and <code>original</code> versions.</li></ul></li><li><p>Use <code>base</code> and <code>delta</code> models. Looks something like this (there are variations that flip which comes first, and
what they&#x27;re called):</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/validation.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"> </span><span class="token comment" style="color:#999999">// petValidator defines the interface for checking business rules for a pet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token plain"> petValidator </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     </span><span class="token comment" style="color:#999999">// Validate The base Pet is assumed to be required, so that is a value type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     </span><span class="token comment" style="color:#999999">// The delta is optional, so it&#x27;s a pointer type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     </span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> pet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> delta </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For this pattern, the following explains what <code>pet</code> (a.k.a. the <code>base</code>) and <code>delta</code> would contain for <code>create</code> vs
<code>update</code>:</p><ol><li><code>create</code>: <code>pet</code> would contain the information for the new <code>Pet</code>, while <code>delta</code> would be <code>nil</code>.</li><li><code>update</code>: <code>pet</code> would contain the original <code>Pet</code>, while <code>delta</code> would contain the <em>changes</em> requested.</li></ol><p>Pros:</p><ul><li>Can easily see in the validation functions what the requested changes are, at least for fields that aren&#x27;t
being set to <code>nil</code>, otherwise have to compare to the original to see if you&#x27;re changing from a value to <code>nil</code>.</li></ul><p>Cons:</p><ul><li>Not validating the version of the model that would be saved to the database, meaning there&#x27;s potentially room
for errors to be introduced when the original model gets the requested changes applied.</li></ul></li></ol><p>For the purposes of these docs, we&#x27;ll use the first pattern shown, using the merged and original versions of the <code>Pet</code>.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="implementing-the-validate-interface">Implementing the <code>Validate</code> Interface<a href="#implementing-the-validate-interface" class="hash-link" aria-label="Direct link to implementing-the-validate-interface" title="Direct link to implementing-the-validate-interface">​</a></h5><p>Now that we&#x27;ve settled on a signature, we can also add the type that will implement this interface. We will make the
type a function type, which will enable us to write our rules using <a href="https://gobyexample.com/closures" target="_blank" rel="noopener noreferrer">closures</a>. We
can define this new type in the <code>validation.go</code> file, under the validator interface we defined in the previous section.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/validation.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// petValidator defines the interface for checking business rules for a pet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token plain"> petValidator </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">// Validate The newPet is assumed to be required, so that is a value type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">// The originalPet is optional, so it&#x27;s a pointer type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// petValidatorFunc is an adapter that will convert a function into an implementation of petValidator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token plain"> petValidatorFunc </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// Validate fulfills the petValidator interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">fn petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">fn</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that all of these function signatures are the exact same. <strong>They must stay the same</strong> so that these types implement
the <code>petValidator</code> interface defined above. Such is the nature of interfaces types. It might feel inconvenient to repeat
this signature over and over, but at least it forces us to be explicit about our input.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-validatemodel-function">Create the <code>validate&lt;Model&gt;</code> Function<a href="#create-the-validatemodel-function" class="hash-link" aria-label="Direct link to create-the-validatemodel-function" title="Direct link to create-the-validatemodel-function">​</a></h4><p>Now we&#x27;re going to define the function that will take in the necessary data and the validation functions that we
should run, run through all the validation functions, and return an error as appropriate. It will be called from the
service objects, meaning it will be the access point for all our validation.</p><p>We&#x27;ll name this function based on what you are validating, so in our case, we&#x27;ll name it <code>validatePet</code>. Its
signature will look similar to the signatures we used earlier, with the addition of a new parameter called <code>checks</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/validation.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// Previous definitions omitted to focus on the new part for now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// validatePet runs a pet through the checks that are passed in.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">validatePet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> checks </span><span class="token operator" style="color:#d7deea">...</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">// TODO: Implement validation logic...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This <code>checks</code> parameter is what is known as a &quot;variadic parameter,&quot; making this a
<a href="https://gobyexample.com/variadic-functions" target="_blank" rel="noopener noreferrer">variadic function</a>. This allows us to pass in however many rules we want,
granting us flexibility in how we validate services, for example, using different checks depending on who is using it.</p><p>Let&#x27;s start defining the logic for our function by adding code to loop through our validators, calling the
<code>Validate</code> method on each of them: </p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/validation.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// Previous definitions omitted to focus on the new part for now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// validatePet runs a pet through the checks that are passed in.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">validatePet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> checks </span><span class="token operator" style="color:#d7deea">...</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">for</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> check </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">range</span><span class="token plain"> checks </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> check</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token comment" style="color:#999999">// TODO: Handle errors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After we call <code>Validate()</code>, we must handle the error that comes back. We have a couple of guidelines for doing this:</p><ul><li>The <a href="https://pkg.go.dev/github.com/gobuffalo/validate" target="_blank" rel="noopener noreferrer">Go Buffalo type <code>validate.Errors</code></a> (commonly assigned to
<code>verrs</code>) should be used to track input errors per field. We do this so the user can get as much information back as
possible instead of only seeing one error per request.<ul><li>Use <code>Add(fieldName str, Message str)</code> to add individual errors to this type one at a time.</li><li>Use <code>Append(verrs validate.Errors)</code> to combine lists of validation errors.</li></ul></li><li>All validation errors should be wrapped in a <code>apperror.InvalidInputError</code> type when returned.</li><li>Any other error types are not combined and take immediate precedence over input errors. For example, the error saying
that the model should not have been visible to the caller will take precedence over an error about the phone number
being mistyped.</li></ul><p>In order to follow these guidelines, we need to check the type of the error being returned from the validator. If
the error is a validation error type, we will combine it with an ongoing list of validation errors and continue
checking the rest of the validators.</p><p>If it is <em>not</em> a validation error, we stop everything and return it right away.</p><p>Taking those guidelines into account, we end up with this <code>validatePet</code> function:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/validation.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// Previous definitions omitted to focus on the new part for now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// validatePet runs a pet through the checks that are passed in.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">validatePet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> checks </span><span class="token operator" style="color:#d7deea">...</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">for</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> check </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">range</span><span class="token plain"> checks </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> check</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">switch</span><span class="token plain"> e </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">case</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Errors</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token comment" style="color:#999999">// Accumulate all validation errors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Append</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">default</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token comment" style="color:#999999">// Non-validation errors have priority and short-circuit doing any further checks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">HasAny</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> apperror</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewInvalidInputError</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> verrs</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Invalid input found while validating the pet.&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function is almost entirely boilerplate and can be copied and pasted from one service to another with minimal
changes.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="testing-validationgo">Testing <code>validation.go</code><a href="#testing-validationgo" class="hash-link" aria-label="Direct link to testing-validationgo" title="Direct link to testing-validationgo">​</a></h4><p>Since most of the code is boilerplate, we can get by with just a few small tests to make sure things work as
expected. Here is a sample of what your tests could look like (or you can even copy these and modify to fit your
function signatures):</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Sample `validation_test.go`</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/validation_test.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gobuffalo/validate/v3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gofrs/uuid&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/apperror&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite PetSuite</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">TestPetValidatorFuncValidate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Calling Validate runs validation function with no errors&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        validator </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validator</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NoError</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Calling Validate runs validation function with errors&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        validator </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;ID&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;fake error&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validator</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Contains</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;fake error&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite PetSuite</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">TestValidatePet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Runs validation and returns nil when there are no errors&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        checkAlwaysReturnNil </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">validatePet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">checkAlwaysReturnNil</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token operator" style="color:#d7deea">...</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NoError</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Runs validation and returns input errors&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        checkAlwaysReturnValidationErr </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;ID&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;fake error&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">validatePet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">checkAlwaysReturnValidationErr</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token operator" style="color:#d7deea">...</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">IsType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">apperror</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">InvalidInputError</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Contains</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Invalid input found while validating the pet.&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Runs validation and returns other errors&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        checkAlwaysReturnOtherError </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> apperror</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewNotFoundError</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Must</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewV4</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Pet not found.&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">validatePet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">checkAlwaysReturnOtherError</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token operator" style="color:#d7deea">...</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">IsType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">apperror</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">NotFoundError</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Contains</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Pet not found.&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h4 class="anchor anchorWithStickyNavbar_LWe7" id="final-validationgo">Final <code>validation.go</code><a href="#final-validationgo" class="hash-link" aria-label="Direct link to final-validationgo" title="Direct link to final-validationgo">​</a></h4><p>Just to recap, here is what our final <code>validation.go</code> file looks like:</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Final `validation.go`</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/validation.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gobuffalo/validate/v3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/apperror&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// petValidator defines the interface for checking business rules for a pet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token plain"> petValidator </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">// Validate The newPet is assumed to be required, so that is a value type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">// The originalPet is optional, so it&#x27;s a pointer type.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// petValidatorFunc is an adapter that will convert a function into an implementation of petValidator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token plain"> petValidatorFunc </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// Validate fulfills the petValidator interface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">fn petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">fn</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// validatePet runs a pet through the checks that are passed in.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">validatePet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> checks </span><span class="token operator" style="color:#d7deea">...</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">for</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> check </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">range</span><span class="token plain"> checks </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> check</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">switch</span><span class="token plain"> e </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">case</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Errors</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token comment" style="color:#999999">// Accumulate all validation errors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Append</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">default</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token comment" style="color:#999999">// Non-validation errors have priority and short-circuit doing any further checks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">HasAny</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> apperror</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewInvalidInputError</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> verrs</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Invalid input found while validating the pet.&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rulesgo"><code>rules.go</code><a href="#rulesgo" class="hash-link" aria-label="Direct link to rulesgo" title="Direct link to rulesgo">​</a></h3><p>Now we&#x27;ll create the <code>rules.go</code> and <code>rules_test.go</code> files. In the <code>rules.go</code> file, we&#x27;ll use the types defined in
<code>validation.go</code>, so make sure you&#x27;ve done that first. You&#x27;ll also need to know what your business rules are.</p><p>For our example, here are a few potential rules (for the sake of brevity, we won&#x27;t actually implement them all):</p><ul><li><code>ID</code> must be blank when creating a <code>Pet</code>.</li><li>Check that <code>Type</code> isn&#x27;t an empty string.</li><li>Check that <code>Name</code> is not empty and doesn&#x27;t contain invalid characters.</li><li>Check that, if both <code>Birthday</code> and <code>GotchaDay</code> are defined, <code>Birthday</code> is equal to, or earlier than the <code>GotchaDay</code>.</li><li>Check that, if <code>Weight</code> is defined, it is greater than 0.</li></ul><p>We&#x27;ll start by defining the functions for our rules like this:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token comment" style="color:#999999">// TODO: implement validation logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token comment" style="color:#999999">// TODO: implement validation logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token comment" style="color:#999999">// TODO: implement validation logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>These functions are <a href="https://gobyexample.com/closures" target="_blank" rel="noopener noreferrer"><strong>closures</strong></a>, which uses a function within a function.
In this case, the outer function has no parameters and returns the <code>petValidator</code> interface type.</p><p>The <em>inner</em> function, however, must have a signature that is exactly the same as our <code>petValidatorFunc</code> function type so
that we can use the interface. This means you will have to change all of these rule functions if you ever change that
base signature, so keep that in mind as you continue working on validation.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="checkid"><code>checkID</code><a href="#checkid" class="hash-link" aria-label="Direct link to checkid" title="Direct link to checkid">​</a></h4><p>We&#x27;ve defined the function name and signature, so we can write our tests for what we expect to happen (minimized for
ease of reading the page): </p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Tests for `checkID`</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules_test.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gobuffalo/validate/v3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gofrs/uuid&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">PetSuite</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">TestCheckID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Success&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Create Pet without an ID&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NilOrNoVerrs</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Update Pet with matching ID&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            id </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Must</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewV4</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NilOrNoVerrs</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Failure&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Return an error if an ID is defined when creating a Pet&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Must</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewV4</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">IsType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Errors</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Contains</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;when creating a Pet ID must not be set&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Return an error if the IDs don&#x27;t match&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Must</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewV4</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Must</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewV4</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">IsType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Errors</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Contains</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;new Pet ID must match original Pet ID&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>Now we can implement the function like so:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gobuffalo/validate/v3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// checkID checks that newPet doesn&#x27;t already have an ID if we&#x27;re creating a Pet, or that it matches the original Pet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// for updates.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">        verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">IsNil</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;ID&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;when creating a Pet ID must not be set&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> originalPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;ID&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;new Pet ID must match original Pet ID&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You may notice we use <code>_</code> for the <code>appcontext.AppContext</code> param since we don&#x27;t need it for this rule. Since we need
a verbose signature to fit our needs for <em>all</em> of these rules, there is no way we&#x27;re going to use everything in
every single rule. Use <code>_</code> to make clear what is relevant and what isn&#x27;t.</p><p>You can also see that we start the inner function off by initializing <code>verrs</code> to hold our validation errors. We
always return this at the end of our rule functions.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="checktype"><code>checkType</code><a href="#checktype" class="hash-link" aria-label="Direct link to checktype" title="Direct link to checktype">​</a></h4><p>Based on our business rules, we want to make sure that <code>Pet.Type</code> is always set. We set up the model and table such
that only a few values are valid, but the way the model works, it still allows a blank string to be set, so we want
to check for that. Our tests for this one will look like this (minimized for ease of reading the page):</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Tests for `checkType`</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules_test.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gobuffalo/validate/v3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gofrs/uuid&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// TestCheckID tests omitted for clarity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">PetSuite</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">TestCheckType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Success&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Create Pet&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Type</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">PetTypeCat</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Fluffy&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NilOrNoVerrs</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Update Pet&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Type</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">PetTypeDog</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">   uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Must</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewV4</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Type</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">PetTypeCat</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Fluffy&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NilOrNoVerrs</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Failure&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Return an error for an empty pet type&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Fluffy&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">IsType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Errors</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Contains</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;type of pet must be specified&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>Now we can implement the function like so:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gobuffalo/validate/v3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// other check functions omitted to focus on checkType</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// checkType checks that newPet.Type is not an empty string.</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Type </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Type&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;type of pet must be specified&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="checkname"><code>checkName</code><a href="#checkname" class="hash-link" aria-label="Direct link to checkname" title="Direct link to checkname">​</a></h4><p>For this one, we&#x27;ll take advantage of the fact that we&#x27;re using <code>closures</code>.</p><p>Let&#x27;s pretend that we have a service that we use to check strings to make sure they don&#x27;t have invalid characters
(e.g. strings that could be used run malicious code). Imagine the service interface looks like this:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/string_checker.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> services</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// StringChecker validates a string of text to make sure it is safe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">//go:generate mockery --name StringChecker --disable-version-string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">type</span><span class="token plain"> StringChecker </span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> text </span><span class="token builtin" style="color:#D8DEE9">string</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We haven&#x27;t covered how you&#x27;re supposed to use service objects, but the important points to know for now are:</p><ul><li>To define something as using this service object&#x27;s type, we would use <code>services.StringChecker</code></li><li>To mock it out in tests, you can use<code>mocks.NewStringChecker(suite.T())</code><ul><li>This will give you a pointer to the mock and set it up so that when the test is cleaning up, it will assert
any expectations you set up actually happened (i.e. if you said it will be called with xyz, it will verify it
was called with that).  </li></ul></li><li>To use it in our service, we&#x27;ll define a parameter like this: <code>stringChecker services.StringChecker</code><ul><li>We then use it like this: <code>err := stringChecker(appCtx, &quot;my string to check&quot;)</code></li></ul></li></ul><p>We&#x27;ll see all this in practice next.</p><p>Now let&#x27;s say we want to run every name that gets input through our string checker to make sure that users aren&#x27;t
passing in bad characters or strings. We can do this by updating our definition of <code>checkName</code> to look like this:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/services&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// other check functions omitted to focus on checkName</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// checkName checks that a name has been input or that one is already set, and runs the string through a string checker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// service.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker services</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">StringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token comment" style="color:#999999">// TODO: implement validation logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note how we added <code>stringChecker services.StringChecker</code> as a parameter to <code>checkName</code>, the outer function. Since
we&#x27;re using <code>closures</code>, we&#x27;ll be able to use this <code>StringChecker</code> service in the inner function, without having to
change the signature of the inner function (and by extension every other validation function).</p><p>With our newly updated function signature, we&#x27;re ready to write our tests!</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Tests for `checkID`</summary><div><div class="collapsibleContent_i85q"><p>We&#x27;ll go into more detail on how we&#x27;re using the mocks later, but the main thing to get from this for now is that we
want to ensure:</p><ul><li>A pet has a name. This means either a new name is set, or the new name matches the old name.</li><li>A new name has no invalid characters.</li></ul><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules_test.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;errors&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;fmt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gobuffalo/validate/v3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gofrs/uuid&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/stretchr/testify/mock&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/services/mocks&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// TestCheckID and TestCheckType tests omitted for clarity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">PetSuite</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">TestCheckName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    getMockStringChecker </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">willBeUsed </span><span class="token builtin" style="color:#D8DEE9">bool</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">mocks</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">StringChecker </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        stringChecker </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> mocks</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewStringChecker</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">T</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> willBeUsed </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            stringChecker</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">On</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Validate&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                mock</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AnythingOfType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;*appcontext.appContext&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                mock</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AnythingOfType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;string&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Return</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> stringChecker</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Success&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        newName </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Luna&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        oldName </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Whiskers&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Create Pet&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            stringChecker </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getMockStringChecker</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">true</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> newName</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NilOrNoVerrs</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Update Pet&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            petID </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Must</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewV4</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            stringChecker </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getMockStringChecker</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">true</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">   petID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> newName</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">   petID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> oldName</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NilOrNoVerrs</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Update with no name change&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            petID </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Must</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewV4</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            stringChecker </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getMockStringChecker</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">false</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">   petID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> oldName</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">   petID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> oldName</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NilOrNoVerrs</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Failure&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        blankNameError </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> errors</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">New</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;pet name must be defined&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        stringCheckError </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> errors</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">New</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;invalid characters found in string&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        invalidName </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;&lt;hacked&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        invalidCases </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">map</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token builtin" style="color:#D8DEE9">string</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token keyword" style="color:#c5a5c5">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            newPetName  </span><span class="token builtin" style="color:#D8DEE9">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            expectedErr </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token string" style="color:#8dc891">&quot;creating with no name&quot;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token string" style="color:#8dc891">&quot;&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                blankNameError</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token string" style="color:#8dc891">&quot;creating with invalid name&quot;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                invalidName</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                stringCheckError</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token string" style="color:#8dc891">&quot;updating with invalid name&quot;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                invalidName</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    ID</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">   uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Must</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewV4</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Whiskers&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                stringCheckError</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">for</span><span class="token plain"> tc</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> testData </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">range</span><span class="token plain"> invalidCases </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            tc </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> tc</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            testData </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> testData</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Run</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">fmt</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Sprintf</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Return error for an invalid name when %v&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> tc</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                stringChecker </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">getMockStringChecker</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">testData</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">newPetName </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> stringCheckError</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                newPet </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">Name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> testData</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">newPetName</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> testData</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">originalPet </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> testData</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">originalPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">AppContextForTest</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    newPet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                    testData</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">originalPet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">IsType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Errors</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                suite</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Contains</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> testData</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">expectedErr</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>Now we can implement our <code>checkName</code> function:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gobuffalo/validate/v3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/services&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// other check functions omitted to focus on checkName</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// checkName checks that a name has been input or that one is already set, and runs the string through a string checker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// service.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker services</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">StringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Name </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Name&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;pet name must be defined&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">&amp;&amp;</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Name </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> originalPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Name </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> stringChecker</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Name&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As stated earlier, we&#x27;re able to pass in the <code>services.StringChecker</code> in to the outer function and then use it in
the inner function. </p><p>This then leads to a question: What should go in the validator signature (inner function) and what goes in the
signature of the outer function?</p><p>There is a lot of room for interpretation with this, but some general guidelines are:</p><ul><li>If it&#x27;s a dependency that can be set up before the service function is called, pass it in as the input of the outer
function.</li><li>If it&#x27;s data that <em>must</em> be retrieved <em>during</em> the service function, it should be in the validator function signature.</li></ul><p>The parameters in the outer functions are like <em>dependencies</em>, and the validator function signature is the true input.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="grouping-rules-functions">Grouping <code>rules</code> Functions<a href="#grouping-rules-functions" class="hash-link" aria-label="Direct link to grouping-rules-functions" title="Direct link to grouping-rules-functions">​</a></h4><p>Once we have some rules, we can start grouping them as needed. For example, we could group them based on which set
of users require different rules. The key here is to define functions that will return slices of validator functions,
instead of constant slice variables.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// Other logic left out for brevity.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// customerChecks are the rules that should run for actions taken by customers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">customerChecks</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker services</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">StringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// officeChecks are the rules that should run for actions taken by office users</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">officeChecks</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The power of this pattern is that it lets us easily define that for customers, we want to check the Pet names, but
we&#x27;ll let office users input whatever they want for names. </p><p>You&#x27;ll notice that we&#x27;re calling our <code>check&lt;thing&gt;</code> functions now, but this isn&#x27;t triggering validation. These are
<code>closures</code>, so we&#x27;re calling the outer function, which is returning our validator. The validators that we get back
aren&#x27;t called until <code>validatePet</code> is called.</p><p>Note that we <em>do</em> pass in whatever parameters we use in the outer functions at this level. This is where we set those
&quot;dependencies&quot;.</p><p>These grouping functions can be used in multiple places, and are meant for utility. They are not a hard requirement to
implement the validator pattern, but they are helpful organizational tools.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="final-rulesgo">Final <code>rules.go</code><a href="#final-rulesgo" class="hash-link" aria-label="Direct link to final-rulesgo" title="Direct link to final-rulesgo">​</a></h4><p>Here is the final rules file that we have:</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Final `rules.go` file</summary><div><div class="collapsibleContent_i85q"><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockTitle_Ktv7">pkg/services/pet/rules.go</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">package</span><span class="token plain"> pet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/gobuffalo/validate/v3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/appcontext&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/models&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token string" style="color:#8dc891">&quot;github.com/transcom/mymove/pkg/services&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// checkID checks that newPet doesn&#x27;t already have an ID if we&#x27;re creating a Pet, or that it matches the original Pet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// for updates.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">IsNil</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;ID&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;ID must not be set when creating a Pet.&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> originalPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;ID&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;ID for new Pet must match original Pet ID.&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// checkType checks that newPet.Type is not an empty string.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Type </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Type&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Type of pet must be specified.&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// checkName checks that a name has been input or that one is already set, and runs the string through a string checker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// service.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker services</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">StringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">petValidatorFunc</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx appcontext</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">AppContext</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        verrs </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">NewErrors</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Name </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Name&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Pet name must be defined.&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> originalPet </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">&amp;&amp;</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Name </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> originalPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Name </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> stringChecker</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">appCtx</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> newPet</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            verrs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Add</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Name&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> verrs</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// customerChecks are the rules that should run for actions taken by customers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">customerChecks</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker services</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">StringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkName</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">stringChecker</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token comment" style="color:#999999">// officeChecks are the rules that should run for actions taken by office users</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">officeChecks</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">petValidator</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkID</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token function" style="color:#79b6f2">checkType</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h2 class="anchor anchorWithStickyNavbar_LWe7" id="recap">Recap<a href="#recap" class="hash-link" aria-label="Direct link to Recap" title="Direct link to Recap">​</a></h2><p>So now we&#x27;ve written rules for what validation we expect to happen with our data, and we&#x27;ve set up the validation
function that we can call to run through those rules. Now you can move on to setting up the actual service object.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h2><ul><li>Shipment Orchestrator<ul><li><a href="https://github.com/transcom/mymove/blob/main/pkg/services/orchestrators/shipment/rules.go" target="_blank" rel="noopener noreferrer">https://github.com/transcom/mymove/blob/main/pkg/services/orchestrators/shipment/rules.go</a></li><li><a href="https://github.com/transcom/mymove/blob/main/pkg/services/orchestrators/shipment/validation.go" target="_blank" rel="noopener noreferrer">https://github.com/transcom/mymove/blob/main/pkg/services/orchestrators/shipment/validation.go</a></li></ul></li><li>PPMShipments<ul><li><a href="https://github.com/transcom/mymove/blob/main/pkg/services/ppmshipment/rules.go" target="_blank" rel="noopener noreferrer">https://github.com/transcom/mymove/blob/main/pkg/services/ppmshipment/rules.go</a></li><li><a href="https://github.com/transcom/mymove/blob/main/pkg/services/ppmshipment/validation.go" target="_blank" rel="noopener noreferrer">https://github.com/transcom/mymove/blob/main/pkg/services/ppmshipment/validation.go</a></li></ul></li><li>Reweighs<ul><li><a href="https://github.com/transcom/mymove/blob/main/pkg/services/reweigh/rules.go" target="_blank" rel="noopener noreferrer">https://github.com/transcom/mymove/blob/main/pkg/services/reweigh/rules.go</a></li><li><a href="https://github.com/transcom/mymove/blob/main/pkg/services/reweigh/validation.go" target="_blank" rel="noopener noreferrer">https://github.com/transcom/mymove/blob/main/pkg/services/reweigh/validation.go</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a href="#resources" class="hash-link" aria-label="Direct link to Resources" title="Direct link to Resources">​</a></h2><ul><li>Interfaces<ul><li><a href="https://gobyexample.com/interfaces" target="_blank" rel="noopener noreferrer">Go by Example: Interfaces</a></li><li><a href="https://golangbot.com/interfaces-part-1/" target="_blank" rel="noopener noreferrer">Interfaces in Go</a></li></ul></li><li>Function types<ul><li><a href="https://stackoverflow.com/questions/9398739/working-with-function-types-in-go" target="_blank" rel="noopener noreferrer">Working with function types in Go</a></li><li><a href="https://yourbasic.org/golang/function-pointer-type-declaration/" target="_blank" rel="noopener noreferrer">Function types and values</a></li></ul></li><li>Variadic functions<ul><li><a href="https://gobyexample.com/variadic-functions" target="_blank" rel="noopener noreferrer">Go by Example: Variadic Functions</a></li><li><a href="https://golangbot.com/variadic-functions/" target="_blank" rel="noopener noreferrer">Variadic Functions</a></li><li><a href="https://www.digitalocean.com/community/tutorials/how-to-use-variadic-functions-in-go" target="_blank" rel="noopener noreferrer">How to use variadic functions in Go</a></li></ul></li><li>Closures<ul><li><a href="https://stackoverflow.com/a/7464475" target="_blank" rel="noopener noreferrer">What is a closure</a></li><li><a href="https://betterprogramming.pub/closures-made-simple-with-golang-69db3017cd7b" target="_blank" rel="noopener noreferrer">Closures in Go</a></li><li><a href="https://gobyexample.com/closures" target="_blank" rel="noopener noreferrer">Go by Example: Closures</a></li><li><a href="https://www.calhoun.io/5-useful-ways-to-use-closures-in-go/" target="_blank" rel="noopener noreferrer">5 useful ways to use closures in Go</a></li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/transcom/mymove-docs/edit/main/docs/backend/guides/service-objects/validation.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/mymove-docs/docs/backend/guides/service-objects/set-up-service-subpackage-and-interface"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Set Up Service Subpackage and Interface</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mymove-docs/docs/backend/guides/service-objects/implementation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Implementation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-pattern" class="table-of-contents__link toc-highlight">The Pattern</a></li><li><a href="#implementing-the-pattern" class="table-of-contents__link toc-highlight">Implementing the Pattern</a><ul><li><a href="#validationgo" class="table-of-contents__link toc-highlight"><code>validation.go</code></a></li><li><a href="#rulesgo" class="table-of-contents__link toc-highlight"><code>rules.go</code></a></li></ul></li><li><a href="#recap" class="table-of-contents__link toc-highlight">Recap</a></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a></li><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/about">About MilMove</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/adrs">Architecture Decision Records</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/frontend">Frontend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/backend">Backend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/api">API</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/tools">Tools</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/transcom/mymove-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">MilMove Documentation GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="footer__link-item">MilMove GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://6130eb5cde15830007fdf57b--docusaurus-2.netlify.app/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus Official Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright 2023  U.S. Federal Government (in countries where recognized) and TrussWorks. Built with Docusaurus.</div></div></div></footer></div>
<script src="/mymove-docs/assets/js/runtime~main.cb78340e.js"></script>
<script src="/mymove-docs/assets/js/main.70764974.js"></script>
</body>
</html>