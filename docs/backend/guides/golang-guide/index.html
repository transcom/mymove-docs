<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-backend/guides/golang-guide">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Golang Programming Guide | MilMove Developer Portal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://transcom.github.io/mymove-docs/docs/backend/guides/golang-guide"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Golang Programming Guide | MilMove Developer Portal"><meta data-rh="true" name="description" content="Style and Conventions"><meta data-rh="true" property="og:description" content="Style and Conventions"><link data-rh="true" rel="icon" href="/mymove-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://transcom.github.io/mymove-docs/docs/backend/guides/golang-guide"><link data-rh="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/backend/guides/golang-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://transcom.github.io/mymove-docs/docs/backend/guides/golang-guide" hreflang="x-default"><link rel="stylesheet" href="/mymove-docs/assets/css/styles.65849403.css">
<link rel="preload" href="/mymove-docs/assets/js/runtime~main.2d8cf14e.js" as="script">
<link rel="preload" href="/mymove-docs/assets/js/main.72cd5155.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mymove-docs/"><div class="navbar__logo"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/mymove-docs/img/logo.svg" alt="MilMove Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">MilMove Documentation</b></a><a class="navbar__item navbar__link" href="/mymove-docs/docs/about/">About</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/adrs">ADRs</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/frontend">Frontend</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mymove-docs/docs/backend">Backend</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/integrations">Integrations</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/api">API</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/tools">Tools</a><a class="navbar__item navbar__link" href="/mymove-docs/docs/help/index">Help</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">mymove<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mymove-docs/docs/backend">MilMove Backend</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mymove-docs/docs/backend/testing/acceptance-testing-syncada-edi-invoicing">Testing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/mymove-docs/docs/backend/guides/service-objects/overview">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/mymove-docs/docs/backend/guides/service-objects/overview">Service Objects</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/backend-structure">Backend Structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/tariff400ng_items-update-data">Adding ShipmentLineItem records to the 400ng table (tariff400ng_items)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/database">Database Guides</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/feature-flags-in-the-app">Feature flags in the app</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/mymove-docs/docs/backend/guides/ghc/ghc-invoicing">Global Household Goods Contract</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/mymove-docs/docs/backend/guides/how-to/add-an-event-trigger">How-to guides</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/troubleshoot-gex-connection">Troubleshoot GEX Connection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/tariff400ng-yearly-import">Importing tariff400ng data for the year</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/troubleshoot-precommit-hook-failures">Precommit Hooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/route-planner">Route Planner Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/session-management">Session management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/roles-and-permissions">Roles and Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/switching-over-to-nix">Switching over to Nix</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/golang-time">Time in Golang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/golang-loops">Loop Iteration in Golang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/tspp-data-creation">Turning TDL scores and TSP discounts into transportation service provider performances</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/use-optimistic-locking">What Is Optimistic Locking?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/zip-code-to-rate-area-mappings">Zip code to Rate area mappings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/wip-server-side-validation">WIP server-side validation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/debugging-sql-tests">Debugging SQL Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/guide-to-history-and-audit-logging">History and Audit Logging Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/open-telemetry">Open Telemetry</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/mymove-docs/docs/backend/guides/environment_variables/">Environment Variables</a><button aria-label="Toggle the collapsible sidebar category &#x27;Environment Variables&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mymove-docs/docs/backend/guides/golang-guide">Golang Programming Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/understanding-milmove-routing">Understanding MilMove Routing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mymove-docs/docs/backend/guides/use-stateless-services-with-app-context">AppContext: how and when to use it</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/mymove-docs/docs/backend/setup/configure-postico-or-tableplus-to-connect-to-mymove-db">Setup</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/mymove-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Golang Programming Guide</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Golang Programming Guide</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="style-and-conventions">Style and Conventions<a href="#style-and-conventions" class="hash-link" aria-label="Direct link to Style and Conventions" title="Direct link to Style and Conventions">​</a></h2><p>Generally speaking, we will follow the recommendations laid out in <a href="https://github.com/golang/go/wiki/CodeReviewComments" target="_blank" rel="noopener noreferrer">Go Code Review Comments</a>. By its own admission, this page:</p><blockquote><p><em>...collects common comments made during reviews of Go code, so that a single detailed explanation can be referred to by shorthands. This is a laundry list of common mistakes, not a style guide.</em></p></blockquote><p>Despite not being an official style guide, it covers a good amount of scope in a concise format, and should be able to keep our project code fairly consistent.</p><p>Beyond what is described above, the following contain additional insights into how to write better Go code.</p><ul><li><a href="https://talks.golang.org/2014/names.slide#1" target="_blank" rel="noopener noreferrer">What&#x27;s in a name?</a> (how to name things in Go)</li><li><a href="https://peter.bourgon.org/go-best-practices-2016/" target="_blank" rel="noopener noreferrer">Go best practices, six years in</a></li><li><a href="https://peter.bourgon.org/blog/2017/06/09/theory-of-modern-go.html" target="_blank" rel="noopener noreferrer">A theory of modern Go</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="acronyms">Acronyms<a href="#acronyms" class="hash-link" aria-label="Direct link to Acronyms" title="Direct link to Acronyms">​</a></h3><p>Domain concepts should be used without abbreviation when used alone.</p><table><thead><tr><th align="left">Do</th><th align="left">Avoid</th></tr></thead><tbody><tr><td align="left"><code>TransportationServiceProvider</code></td><td align="left"><code>TSP</code></td></tr><tr><td align="left"><code>TrafficDistributionList</code></td><td align="left"><code>TDL</code></td></tr></tbody></table><p>However, when used as a specifier or part of another name, names that have existing acronyms should use the acronym for brevity.</p><table><thead><tr><th align="left">Do</th><th align="left">Avoid</th></tr></thead><tbody><tr><td align="left"><code>TSPPerformance</code></td><td align="left"><code>TransportationServiceProviderPerformance</code></td></tr></tbody></table><p>Acronyms should always be either all caps or all lower-cased.</p><table><thead><tr><th align="left">Do</th><th align="left">Avoid</th></tr></thead><tbody><tr><td align="left"><code>TSPPerformance</code></td><td align="left"><code>tSPPerformance</code></td></tr><tr><td align="left"><code>tspPerformance</code></td><td align="left"><code>tspperformance</code></td></tr><tr><td align="left"></td><td align="left"><code>TspPerformance</code></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="importing-dependencies">Importing Dependencies<a href="#importing-dependencies" class="hash-link" aria-label="Direct link to Importing Dependencies" title="Direct link to Importing Dependencies">​</a></h2><p>Dependencies are managed by <a href="https://github.com/golang/dep" target="_blank" rel="noopener noreferrer">dep</a>. New dependencies are automatically detected in import statements. To add a new dependency to the project:</p><ol><li>Add the package to the import statement of a Go file.</li><li><code>make clean</code></li><li><code>make server_generate</code></li><li><code>dep check</code> (to verify what&#x27;s missing.) If it looks reasonable then...</li><li><code>dep ensure</code></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="querying-the-database-safely">Querying the Database Safely<a href="#querying-the-database-safely" class="hash-link" aria-label="Direct link to Querying the Database Safely" title="Direct link to Querying the Database Safely">​</a></h2><ul><li>SQL statements <em>must</em> use PostgreSQL-native parameter replacement format (e.g. <code>$1</code>, <code>$2</code>, etc.) and <em>never</em> interpolate values into SQL fragments in any other way.</li><li>SQL statements must only be defined in the <code>models</code> package.</li></ul><p>Here is an example of a safe query for a single <code>Shipment</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">// db is a *pop.Connection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">id </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;0186ad95-14ed-4c9b-9f62-d5bd124f62a1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">query </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> db</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Where</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;id = $1&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">shipment </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Shipment</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> query</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">First</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">shipment</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  pp</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Println</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">shipment</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modelsfetch-functions"><code>models.Fetch*</code> functions<a href="#modelsfetch-functions" class="hash-link" aria-label="Direct link to modelsfetch-functions" title="Direct link to modelsfetch-functions">​</a></h3><p>Functions that return model structs should return pointers.</p><p><strong>Do</strong></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">FetchShipment</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">db </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">pop</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Connection</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> id uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UUID</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">Shipment</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Avoid</strong></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">FetchShipment</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">db </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">pop</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Connection</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> id uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UUID</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">Shipment</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is for a few reasons:</p><ul><li>Many Pop methods that accept models need to use pointers in order to modify the struct being passed in. Using them everywhere
models are used makes the code more consistent and avoids needing to convert to and from pointers.</li><li>Any methods on struct model instances need to have pointer receivers in order to mutate the struct. This is a common point of confusion
and an easy way to introduce bugs into a codebase.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Logging<a href="#logging" class="hash-link" aria-label="Direct link to Logging" title="Direct link to Logging">​</a></h2><p>We use the <a href="https://github.com/uber-go/zap" target="_blank" rel="noopener noreferrer">Zap</a> logging framework from Uber to produce structured log records.
To this end, code should avoid using the <a href="https://godoc.org/go.uber.org/zap#Logger.Sugar" target="_blank" rel="noopener noreferrer">SugaredLogger</a>s without
a very explicit reason which should be record in an inline comment where the SugaredLogger is constructed.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging-levels">Logging Levels<a href="#logging-levels" class="hash-link" aria-label="Direct link to Logging Levels" title="Direct link to Logging Levels">​</a></h3><p>Another reason to use the Zap logging package is that it provides more nuanced logging levels than the basic Go logging package.
That said, leveled logging is only meaningful if there is a common pattern in the usage of each logging level. To that end,
the following indicates when each level of Logging should be used.</p><ul><li><p><strong>Fatal</strong> This should never be used outside of the server startup code in main.go. Fatal log messages call <code>sys.exit(1)</code> which unceremoniously kills the server without running any clean up code. This is almost certainly never what you want in production.</p></li><li><p><strong>Error</strong> Reserved for system failures, e.g. cannot reach a database, a DB insert which was expected to work failed,
or an <code>&quot;enum&quot;</code> has an unexpected value. In production an Error logging message should alert the team that
all is not well with the server, so avoid being the &#x27;Boy Who Cried Wolf&#x27;. In particular, if there is an API which takes an object ID as part of the URL,
then passing a bad value in should NOT log an Error message. It should log Info and then return 404.</p></li><li><p><strong>Warn</strong> Don&#x27;t use Warn - it rarely, if ever, adds any meaningful signal to the logs.</p></li><li><p><strong>Info</strong> Use for recording &#x27;Normal&#x27; events at a granularity that may be helpful to tracing and debugging requests,
e.g. 404&#x27;s from requests with bad IDs, authentication events (user logs in/out), authorization failures etc.</p></li><li><p><strong>Debug</strong> Debug events are of questionable value and should be used during development, but probably best removed
before landing changes. The issue with them is, if they are left in the code, they quickly become so dense in the logs
as to obscure other debug log entries. This leads to people an arms race of folks adding &#x27;XXXXXXX&#x27; to comments
in order to identify their log items. If you must use them, I suggest adding an, e.g. zap.String(&quot;owner&quot;, &quot;nick&quot;)</p></li></ul><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Use JSON friendly names for Zap.Objects</div><div class="admonitionContent_S0QG"><p>Use JSON friendly names for <code>zap.Object</code> so that you will be able to extract the values easily in CloudWatch Insights queries.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">s</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">logger</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Info</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;EDIs processed&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> zap</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Object</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;edisProcessed&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">ediProcessing</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>vs</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">s</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">logger</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Info</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;EDIs processed&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> zap</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Object</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;EDIs Processed&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">ediProcessing</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The latter was nearly impossible to filter on. But the following insights query works</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">fields @timestamp, edisProcessed, @message</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">| sort @timestamp desc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="errors">Errors<a href="#errors" class="hash-link" aria-label="Direct link to Errors" title="Direct link to Errors">​</a></h2><p>Some general guidelines for errors:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-dont-bury-your-errors-in-underscores">1. Don&#x27;t bury your errors in underscores.<a href="#1-dont-bury-your-errors-in-underscores" class="hash-link" aria-label="Direct link to 1. Don&#x27;t bury your errors in underscores." title="Direct link to 1. Don&#x27;t bury your errors in underscores.">​</a></h3><p>If a function or other action generates an error, assign it to a variable and either return it as part of your function&#x27;s output or handle it in place (<code>if err != nil</code>, etc.). There will be the very occasional exception to this - one is within tests, depending on the test&#x27;s goal. If you find yourself typing that underscore, take a moment to ask yourself why you&#x27;re choosing that option. On those very rare occasions when it is the correct behavior, please add a comment explaining why.</p><p><em>Don&#x27;t:</em></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">myVal</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">_</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">functionThatShouldReturnAnInt</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Do:</em></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">myVal</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">functionThatShouldReturnAnInt</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> myVal</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Errorf</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;function didn&#x27;t return an int: %w&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-log-at-the-top-level-create-and-pass-along-errors-below">2. Log at the top level; create and pass along errors below.<a href="#2-log-at-the-top-level-create-and-pass-along-errors-below" class="hash-link" aria-label="Direct link to 2. Log at the top level; create and pass along errors below." title="Direct link to 2. Log at the top level; create and pass along errors below.">​</a></h3><p>If you&#x27;re creating a query (1) that is called by a function (2) that is in turned called by another function (3), create and return errors at levels 1 and 2 (and possibly handle them immediately after creation, if needed), and log them at level 3. Logs should be created at the top level and contain context about what created them. This is more difficult if logs are being created in every function and file that supports the operation you&#x27;re working on. Here&#x27;s an example of when to create errors and when to handle them:</p><p>In <code>pkg/models/blackout_dates.go</code>, an error is created and returned:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">FetchTSPBlackoutDates</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">tx </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">pop</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Connection</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> tspID uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UUID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> shipment Shipment</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">BlackoutDate</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token operator" style="color:#d7deea">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  err </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> query</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">All</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">blackoutDates</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> blackoutDates</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Errorf</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Blackout dates query failed: %w&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> blackoutDates</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In <code>pkg/awardqueue/awardqueue.go</code>, <code>FetchTSPBlackoutDates</code> is called, and any possible error is handled. This function also returns an error.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">ShipmentWithinBlackoutDates</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">tspID uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UUID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> shipment models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Shipment</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token builtin" style="color:#D8DEE9">bool</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  blackoutDates</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">FetchTSPBlackoutDates</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">aq</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">db</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> tspID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> shipment</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">false</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Errorf</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Error retrieving blackout dates from database: %w&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">len</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">blackoutDates</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, at the top level in <code>attemptShipmentOffer</code> in the same file, any errors bubbled up from <code>ShipmentWithinBlackoutDates</code> or <code>FetchTSPBlackoutDates</code> are handled definitively, halting the progress of the longer function if the underlying processes and queries didn&#x27;t complete as expected in the functions being called:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">aq </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">AwardQueue</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">attemptShipmentOffer</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">shipment models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Shipment</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ShipmentOffer</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  aq</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">logger</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Info</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Attempting to offer shipment&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> zap</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Any</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;shipment_id&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> shipment</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token operator" style="color:#d7deea">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  isAdministrativeShipment</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> aq</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">ShipmentWithinBlackoutDates</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">tsp</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> shipment</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    aq</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">logger</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Failed to determine if shipment is within TSP blackout dates&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> zap</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token operator" style="color:#d7deea">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The error is created and passed along at the lowest level, logged and passed along at the middle level (along with other errors that can happen within that function), and logged again at the highest level before finally halting the progress of the process if an error is present.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-use-fmterrorf-instead-of-errorsnew">3. Use <code>fmt.Errorf</code> instead of <code>errors.New</code><a href="#3-use-fmterrorf-instead-of-errorsnew" class="hash-link" aria-label="Direct link to 3-use-fmterrorf-instead-of-errorsnew" title="Direct link to 3-use-fmterrorf-instead-of-errorsnew">​</a></h3><p>You should avoid using <code>errors.New</code> when creating an error in go. Please use <code>fmt.Errorf</code> instead.</p><p><em>Current Recommendation:</em></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Errorf</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Some application error message&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Old Recommendation:</em></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> errors</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">New</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Some application error message&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-use-fmterrorf-and-w-verb-when-wrapping-errors">4. Use <code>fmt.Errorf</code> and <code>%w</code> verb when wrapping errors.<a href="#4-use-fmterrorf-and-w-verb-when-wrapping-errors" class="hash-link" aria-label="Direct link to 4-use-fmterrorf-and-w-verb-when-wrapping-errors" title="Direct link to 4-use-fmterrorf-and-w-verb-when-wrapping-errors">​</a></h3><p><a href="https://blog.golang.org/go1.13-errors" target="_blank" rel="noopener noreferrer"><code>fmt.Errorf() with %w</code></a> provides greater error context and a stack trace, making it especially useful when dealing with the opacity that sometimes comes with external libraries. As of go 1.13 <code>fmt.Errorf()</code> provides a new <code>%w</code> verb that replaces the need for <code>errors.Wrap()</code>. It takes a string with the <code>%w</code> in it and the error as parameters: the string and error to provide context and explanation. Keep the string brief and clear, assuming that the fuller cause will be provided by the context <code>%w</code> verb brings. It can also add useful context for errors related to internal code if there might otherwise be unhelpful opacity. <code>fmt.Errorf()</code> in combination with <code>%w</code> also capture stack traces with the additional function of string substitution/formatting for output.</p><p>Instead of just returning the error, offer greater context with something like this:</p><p><em>Current Recommendation:</em></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Errorf</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Pop validate failed: %w&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As this is a recent change in golang standards you will see many uses of the <code>errors.Wrap</code> still in the code, which had been the old recommendation. It is safe to change code that wraps errors as below to the new standard in the example above.</p><p><em>Old Recommendation:</em></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> errors</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Wrap</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Pop validate failed&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Using the new <code>%w</code> provides access to some new features such as the new <code>errors.Is</code> and <code>errors.As</code> functions. For more on the changes in go 1.13 see <a href="https://blog.golang.org/go1.13-errors" target="_blank" rel="noopener noreferrer">this official blog post</a> and <a href="https://medium.com/@felipedutratine/golang-how-to-handle-errors-in-v1-13-fda7f035d027" target="_blank" rel="noopener noreferrer">this article</a> that go into more depth.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-dont-fmt-errors-log-instead">5. Don&#x27;t <code>fmt</code> errors; log instead.<a href="#5-dont-fmt-errors-log-instead" class="hash-link" aria-label="Direct link to 5-dont-fmt-errors-log-instead" title="Direct link to 5-dont-fmt-errors-log-instead">​</a></h3><p><code>fmt</code> can provide useful error handling during initial debugging, but we strongly suggest logging instead, from when you write the initial lines of a new function. Using logging creates structured logs instead of the unstructured, human-friendly-only output that <code>fmt</code> does. If an <code>fmt</code> statement offers usefulness beyond your initial troubleshooting while working, switch it to <code>fmt.Errorf(&quot;text: %w&quot;, err)</code> or <code>logger.Error()</code>, perhaps with <a href="https://github.com/uber-go/zap" target="_blank" rel="noopener noreferrer">Zap</a>.</p><p><em>Don&#x27;t:</em></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">fmt</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Println</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Blackout dates fetch failed: &quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Do:</em></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">logger</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Blackout dates fetch failed: &quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#8dc891">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-if-some-of-your-errors-are-predictable-pattern-match-on-them-to-provide-more-error-detail">6. If some of your errors are predictable, pattern match on them to provide more error detail.<a href="#6-if-some-of-your-errors-are-predictable-pattern-match-on-them-to-provide-more-error-detail" class="hash-link" aria-label="Direct link to 6. If some of your errors are predictable, pattern match on them to provide more error detail." title="Direct link to 6. If some of your errors are predictable, pattern match on them to provide more error detail.">​</a></h3><p>Some errors are predictable, such as those from the database that Pop returns to us. This gives you the option to use those predictable errors to give yourself and fellow maintainers of code more detail than you might get otherwise, like so:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token comment" style="color:#999999">// FetchServiceMemberForUser returns a service member only if it is allowed for the given user to access that service member.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">func</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">FetchServiceMemberForUser</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> db </span><span class="token operator" style="color:#d7deea">*</span><span class="token plain">pop</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Connection</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> user User</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> id uuid</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UUID</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">ServiceMember</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token builtin" style="color:#D8DEE9">error</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">var</span><span class="token plain"> serviceMember ServiceMember</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  err </span><span class="token operator" style="color:#d7deea">:=</span><span class="token plain"> db</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Eager</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Find</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token operator" style="color:#d7deea">&amp;</span><span class="token plain">serviceMember</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> err </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> errors</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Cause</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token function" style="color:#79b6f2">Error</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">==</span><span class="token plain"> recordNotFoundErrorString </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> ServiceMember</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> ErrFetchNotFound</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token comment" style="color:#999999">// Otherwise, it&#x27;s an unexpected err so we return that.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> ServiceMember</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">if</span><span class="token plain"> serviceMember</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">UserID </span><span class="token operator" style="color:#d7deea">!=</span><span class="token plain"> user</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">ID </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> ServiceMember</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> ErrFetchForbidden</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> serviceMember</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also use <code>fmt.Errorf(&quot;text: %w&quot;, err)</code> in this situation to provide access to even more information, beyond the breadcrumbs left here.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="libraries">Libraries<a href="#libraries" class="hash-link" aria-label="Direct link to Libraries" title="Direct link to Libraries">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pop">Pop<a href="#pop" class="hash-link" aria-label="Direct link to Pop" title="Direct link to Pop">​</a></h3><p>We use Pop as the ORM(-ish) to mediate access to the database. <a href="https://andrew-sledge.gitbooks.io/the-unofficial-pop-book/content/" target="_blank" rel="noopener noreferrer">The Unofficial Pop Book</a> is a valuable companion to Pop’s <a href="https://github.com/gobuffalo/pop" target="_blank" rel="noopener noreferrer">GitHub documentation</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="learning">Learning<a href="#learning" class="hash-link" aria-label="Direct link to Learning" title="Direct link to Learning">​</a></h2><p>If you are new to Go, you should work your way through all of these resources (in this order, ideally):</p><ol><li><a href="https://tour.golang.org" target="_blank" rel="noopener noreferrer">A Tour of Go</a> (in-browser interactive language tutorial)</li><li><a href="https://golang.org/doc/code.html" target="_blank" rel="noopener noreferrer">How to Write Go Code</a> (info about the Go environment, testing, etc.)</li><li><a href="https://golang.org/doc/effective_go.html" target="_blank" rel="noopener noreferrer">Effective Go</a> (how to do things “the Go way”)</li><li><a href="https://golang.github.io/dep/docs/daily-dep.html" target="_blank" rel="noopener noreferrer">Daily Dep documentation</a> (common tasks you’ll encounter with our dependency manager)</li><li><a href="http://exercism.io/languages/go/about" target="_blank" rel="noopener noreferrer">Exercism</a> offers a series of exercises with gradually increasing complexity</li></ol><p>Additional resources:</p><ul><li><a href="https://godoc.org/" target="_blank" rel="noopener noreferrer">GoDoc</a> (where you can read the docs for nearly any Go package)</li><li>Check out the <a href="https://github.com/golang/go/wiki/Learn" target="_blank" rel="noopener noreferrer">Go wiki</a></li><li>Advanced Testing with Go <a href="https://www.youtube.com/watch?v=yszygk1cpEc" target="_blank" rel="noopener noreferrer">Video</a> and <a href="https://about.sourcegraph.com/go/advanced-testing-in-go" target="_blank" rel="noopener noreferrer">Article</a> (great overview of useful techniques, useful for all Go programmers)</li><li><em>Book</em>: <a href="http://www.gopl.io/" target="_blank" rel="noopener noreferrer">The Go Programming Language</a></li><li><em>Article</em>: <a href="https://medium.com/@venks.sa/copying-data-from-s3-to-ebs-30x-faster-using-go-e2cdb1093284" target="_blank" rel="noopener noreferrer">Copying data from S3 to EBS 30x faster using Golang</a></li><li><a href="http://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/index.html" target="_blank" rel="noopener noreferrer">50 Shades of Go: Traps, Gotchas, and Common Mistakes for New Golang Devs</a></li><li><a href="https://docs.google.com/document/d/1QQq8Yf90ar59OUQM6qRDS6Bwk5hfOCpcqw_WUX43YOg/edit" target="_blank" rel="noopener noreferrer">Ultimate Go Notebook</a> by Bill Kennedy</li><li><a href="https://www.practical-go-lessons.com" target="_blank" rel="noopener noreferrer">Practical Go Lessons</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-objects">Service Objects<a href="#service-objects" class="hash-link" aria-label="Direct link to Service Objects" title="Direct link to Service Objects">​</a></h2><p>Service Objects are an architectural design pattern we use to encapsulate business logic. Service objects allow for
better unit testing, re-usability, and organization of code in the MilMove project. For more information on service
objects, including how we use them and how to write them, please see the
<a href="/mymove-docs/docs/backend/guides/service-objects/overview">documentation</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">​</a></h2><p>Knowing what deserves a test and what doesn’t can be tricky, especially early on when a project’s testing conventions haven’t been established. Use the following guidelines to determine if and how some code should be tested.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="general">General<a href="#general" class="hash-link" aria-label="Direct link to General" title="Direct link to General">​</a></h3><ul><li>Use table-driven tests where appropriate.</li><li>Make judicious use of helper functions so that the intent of a test is not lost in a sea of error checking and boilerplate. Use <a href="https://golang.org/pkg/testing/#T.Helper" target="_blank" rel="noopener noreferrer"><code>t.Helper()</code></a> in your test helper functions to keep stack traces clean.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="coverage">Coverage<a href="#coverage" class="hash-link" aria-label="Direct link to Coverage" title="Direct link to Coverage">​</a></h3><ul><li>Always test exported functions.
Exported functions should be treated as an API layer for other packages.
Cover the expected behavior and error scenarios as a user of that API.</li><li>Try not to test unexported functions.
Unexported functions are implementation details of exported ones
and should not change the intended usage.
If you find that an unexported function is complex and needs testing,
it might mean it needs to be refactored as it&#x27;s exported function elsewhere.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="models">Models<a href="#models" class="hash-link" aria-label="Direct link to Models" title="Direct link to Models">​</a></h3><p>In general, focus on testing non-trivial behavior.</p><ul><li>Structs do not need to be tested as they have no behavior of their own.</li><li>Struct methods warrant a unit test if they contain important behavior, e.g. validations.</li><li>Avoid testing functionality of libraries, e.g. model saving and loading (which is provided by Pop)</li><li>Try to leverage the type system to ensure that components are “hooked up correctly” instead of writing integration tests.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="time">Time<a href="#time" class="hash-link" aria-label="Direct link to Time" title="Direct link to Time">​</a></h2><p>Some helpful tips on dealing with time in the MilMove Go codebase can be found in <a href="/mymove-docs/docs/backend/guides/golang-time">this doc</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="miscellaneous-tips">Miscellaneous Tips<a href="#miscellaneous-tips" class="hash-link" aria-label="Direct link to Miscellaneous Tips" title="Direct link to Miscellaneous Tips">​</a></h2><ul><li>Use <code>golang</code> instead of <code>go</code> in Google searches.</li><li>Try to use the standard lib as much as possible, especially when learning.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="environment-settings">Environment settings<a href="#environment-settings" class="hash-link" aria-label="Direct link to Environment settings" title="Direct link to Environment settings">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-ulimit">Adding <code>ulimit</code><a href="#adding-ulimit" class="hash-link" aria-label="Direct link to adding-ulimit" title="Direct link to adding-ulimit">​</a></h3><p>Dep appears to open many files simultaneously, particularly as the project matures and depends on more and more third-party repositories. You may encounter a message like this as a <code>dep-status</code> hook error when trying to commit locally: <code>remote repository does not exist, or is inaccessible: : pipe: too many open files</code>.</p><p>To fix this, run <code>ulimit -n 5000</code> in your terminal. This increases the number of file handles (the details on files that a process holds open) on your system. You can run <code>ulimit -n</code> to see how many are currently allowed; you may see a number like 128 or 256. (Run <code>ulimit -a</code> to see all current limits on your system, including pipe size, stack size, and user processes.) If running this in your terminal window allows you to complete your commit, you may wish to add it to <code>/.bash_profile</code> or whichever system file you use for your terminal settings.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/transcom/mymove-docs/edit/main/docs/backend/guides/golang-guide.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/mymove-docs/docs/backend/guides/environment_variables/access-global-variables"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How to Access a Global Application Variable</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mymove-docs/docs/backend/guides/understanding-milmove-routing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Understanding MilMove Routing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#style-and-conventions" class="table-of-contents__link toc-highlight">Style and Conventions</a><ul><li><a href="#acronyms" class="table-of-contents__link toc-highlight">Acronyms</a></li></ul></li><li><a href="#importing-dependencies" class="table-of-contents__link toc-highlight">Importing Dependencies</a></li><li><a href="#querying-the-database-safely" class="table-of-contents__link toc-highlight">Querying the Database Safely</a><ul><li><a href="#modelsfetch-functions" class="table-of-contents__link toc-highlight"><code>models.Fetch*</code> functions</a></li></ul></li><li><a href="#logging" class="table-of-contents__link toc-highlight">Logging</a><ul><li><a href="#logging-levels" class="table-of-contents__link toc-highlight">Logging Levels</a></li></ul></li><li><a href="#errors" class="table-of-contents__link toc-highlight">Errors</a><ul><li><a href="#1-dont-bury-your-errors-in-underscores" class="table-of-contents__link toc-highlight">1. Don&#39;t bury your errors in underscores.</a></li><li><a href="#2-log-at-the-top-level-create-and-pass-along-errors-below" class="table-of-contents__link toc-highlight">2. Log at the top level; create and pass along errors below.</a></li><li><a href="#3-use-fmterrorf-instead-of-errorsnew" class="table-of-contents__link toc-highlight">3. Use <code>fmt.Errorf</code> instead of <code>errors.New</code></a></li><li><a href="#4-use-fmterrorf-and-w-verb-when-wrapping-errors" class="table-of-contents__link toc-highlight">4. Use <code>fmt.Errorf</code> and <code>%w</code> verb when wrapping errors.</a></li><li><a href="#5-dont-fmt-errors-log-instead" class="table-of-contents__link toc-highlight">5. Don&#39;t <code>fmt</code> errors; log instead.</a></li><li><a href="#6-if-some-of-your-errors-are-predictable-pattern-match-on-them-to-provide-more-error-detail" class="table-of-contents__link toc-highlight">6. If some of your errors are predictable, pattern match on them to provide more error detail.</a></li></ul></li><li><a href="#libraries" class="table-of-contents__link toc-highlight">Libraries</a><ul><li><a href="#pop" class="table-of-contents__link toc-highlight">Pop</a></li></ul></li><li><a href="#learning" class="table-of-contents__link toc-highlight">Learning</a></li><li><a href="#service-objects" class="table-of-contents__link toc-highlight">Service Objects</a></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a><ul><li><a href="#general" class="table-of-contents__link toc-highlight">General</a></li><li><a href="#coverage" class="table-of-contents__link toc-highlight">Coverage</a></li><li><a href="#models" class="table-of-contents__link toc-highlight">Models</a></li></ul></li><li><a href="#time" class="table-of-contents__link toc-highlight">Time</a></li><li><a href="#miscellaneous-tips" class="table-of-contents__link toc-highlight">Miscellaneous Tips</a></li><li><a href="#environment-settings" class="table-of-contents__link toc-highlight">Environment settings</a><ul><li><a href="#adding-ulimit" class="table-of-contents__link toc-highlight">Adding <code>ulimit</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/about">About MilMove</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/adrs">Architecture Decision Records</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/frontend">Frontend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/backend">Backend</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/api">API</a></li><li class="footer__item"><a class="footer__link-item" href="/mymove-docs/docs/tools">Tools</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/transcom/mymove-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">MilMove Documentation GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/transcom/mymove" target="_blank" rel="noopener noreferrer" class="footer__link-item">MilMove GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://6130eb5cde15830007fdf57b--docusaurus-2.netlify.app/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus Official Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright 2023  U.S. Federal Government (in countries where recognized) and TrussWorks. Built with Docusaurus.</div></div></div></footer></div>
<script src="/mymove-docs/assets/js/runtime~main.2d8cf14e.js"></script>
<script src="/mymove-docs/assets/js/main.72cd5155.js"></script>
</body>
</html>