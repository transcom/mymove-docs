"use strict";(self.webpackChunkmymove_docs=self.webpackChunkmymove_docs||[]).push([[1192],{33785:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var a=n(87462),i=(n(67294),n(3905));n(8209);const r={sidebar_position:3},o="Acceptance testing payment requests",s={unversionedId:"backend/testing/acceptance-testing-payment-requests",id:"backend/testing/acceptance-testing-payment-requests",title:"Acceptance testing payment requests",description:"Link to a video walk-through example of acceptance testing a payment request. Video in Google Drive",source:"@site/docs/backend/testing/acceptance-testing-payment-requests.md",sourceDirName:"backend/testing",slug:"/backend/testing/acceptance-testing-payment-requests",permalink:"/mymove-docs/docs/backend/testing/acceptance-testing-payment-requests",draft:!1,editUrl:"https://github.com/transcom/mymove-docs/edit/main/docs/backend/testing/acceptance-testing-payment-requests.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"backendSidebar",previous:{title:"Acceptance testing notifications",permalink:"/mymove-docs/docs/backend/testing/acceptance-testing-notifications"},next:{title:"How to run acceptance tests",permalink:"/mymove-docs/docs/backend/testing/run-acceptance-tests"}},c={},l=[{value:"Pricing Acceptance Tool",id:"pricing-acceptance-tool",level:2},{value:"Usage",id:"usage",level:3},{value:"Creating a new MTO with shipments",id:"creating-a-new-mto-with-shipments",level:2},{value:"1. Create a new PPM",id:"1-create-a-new-ppm",level:3},{value:"2. Approve HHG shipments and send to prime",id:"2-approve-hhg-shipments-and-send-to-prime",level:3},{value:"Adding Service Items to a Shipment",id:"adding-service-items-to-a-shipment",level:2},{value:"Adding Crating",id:"adding-crating",level:3},{value:"Add Shuttling",id:"add-shuttling",level:3},{value:"Creating a Payment request",id:"creating-a-payment-request",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Add weights to the shipment",id:"add-weights-to-the-shipment",level:3},{value:"Add SIT-related service items",id:"add-sit-related-service-items",level:3},{value:"Domestic Destination First Day SIT",id:"domestic-destination-first-day-sit",level:4},{value:"Domestic Origin First Day SIT",id:"domestic-origin-first-day-sit",level:4},{value:"Create a Payment Request",id:"create-a-payment-request",level:3},{value:"Development",id:"development",level:4},{value:"Staging",id:"staging",level:4},{value:"Create a Payment Request Upload",id:"create-a-payment-request-upload",level:3},{value:"Development",id:"development-1",level:4},{value:"Staging",id:"staging-1",level:4},{value:"Verifying Pricing",id:"verifying-pricing",level:2},{value:"Domestic Short Haul (DSH)",id:"domestic-short-haul-dsh",level:3},{value:"Domestic Long Haul (DLH)",id:"domestic-long-haul-dlh",level:3},{value:"Domestic Destination Price (DDP)",id:"domestic-destination-price-ddp",level:3},{value:"Domestic Origin Price (DOP)",id:"domestic-origin-price-dop",level:3},{value:"Domestic Packing Price (DPK)",id:"domestic-packing-price-dpk",level:3},{value:"Domestic Unpacking Price (DUPK)",id:"domestic-unpacking-price-dupk",level:3},{value:"Fuel Surcharge Price (FSC)",id:"fuel-surcharge-price-fsc",level:3},{value:"Domestic Destination or Origin First Day SIT (DDFSIT or DOFSIT)",id:"domestic-destination-or-origin-first-day-sit-ddfsit-or-dofsit",level:3},{value:"Domestic Destination or Origin SIT Additional Days (DDASIT or DOASIT)",id:"domestic-destination-or-origin-sit-additional-days-ddasit-or-doasit",level:3},{value:"Domestic Destination Delivery or Origin Pickup SIT (DDDSIT or DOPSIT)",id:"domestic-destination-delivery-or-origin-pickup-sit-dddsit-or-dopsit",level:3},{value:"Domestic Destination Shuttling (DDSHUT)",id:"domestic-destination-shuttling-ddshut",level:3},{value:"Domestic Origin Shuttling (DOSHUT)",id:"domestic-origin-shuttling-doshut",level:3},{value:"Domestic Crating (DCRT)",id:"domestic-crating-dcrt",level:3},{value:"Domestic Uncrating (DUCRT)",id:"domestic-uncrating-ducrt",level:3},{value:"Generate EDI via Support API",id:"generate-edi-via-support-api",level:2},{value:"Prerequisites",id:"prerequisites-1",level:3},{value:"Generate EDI via Support API",id:"generate-edi-via-support-api-1",level:3},{value:"Development",id:"development-2",level:4},{value:"Staging",id:"staging-2",level:4},{value:"Move Task Order actions",id:"move-task-order-actions",level:2},{value:"Create an MTO Shipment via prime API",id:"create-an-mto-shipment-via-prime-api",level:3},{value:"Development",id:"development-3",level:4},{value:"Staging",id:"staging-3",level:4},{value:"Approve MTO Shipment",id:"approve-mto-shipment",level:3},{value:"Via TOO UI",id:"via-too-ui",level:4},{value:"Make MTO available to the prime",id:"make-mto-available-to-the-prime",level:3},{value:"Via TOO UI",id:"via-too-ui-1",level:4},{value:"Via support api",id:"via-support-api",level:4},{value:"Development",id:"development-4",level:4},{value:"Staging",id:"staging-4",level:4},{value:"Issues",id:"issues",level:2},{value:"Errors during service item param lookups don&#39;t bubble up",id:"errors-during-service-item-param-lookups-dont-bubble-up",level:3},{value:"Searching For Errors in Staging",id:"searching-for-errors-in-staging",level:2},{value:"Filters",id:"filters",level:2},{value:"Print only MTO",id:"print-only-mto",level:3},{value:"Print specific MTO Shipment&#39;s eTag",id:"print-specific-mto-shipments-etag",level:3},{value:"Print the most recent MTO based on .updatedAt",id:"print-the-most-recent-mto-based-on-updatedat",level:3},{value:"Print the MTO with a certain moveCode",id:"print-the-mto-with-a-certain-movecode",level:3},{value:"List all of the MTO service items for a shipment",id:"list-all-of-the-mto-service-items-for-a-shipment",level:3},{value:"Generate PR payload from MTO ID and Shipment ID with certain service codes",id:"generate-pr-payload-from-mto-id-and-shipment-id-with-certain-service-codes",level:3}],p={toc:l},m="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(m,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"acceptance-testing-payment-requests"},"Acceptance testing payment requests"),(0,i.kt)("p",null,"Link to a video walk-through example of acceptance testing a payment request. ",(0,i.kt)("a",{parentName:"p",href:"https://drive.google.com/file/d/1yDQAgRxGRGwkiwhUKgaor5C0vMtm6Ek4/view"},"Video in Google Drive")),(0,i.kt)("h2",{id:"pricing-acceptance-tool"},"Pricing Acceptance Tool"),(0,i.kt)("p",null,"In lieu of the following instructions, you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"pricing-acceptance"),"\nscript to kick off the acceptance process for pricing stories."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"This script creates a brand new shipment. To use, first find an approved move\nand use its moveCode or moveID when calling the script.")),(0,i.kt)("h3",{id:"usage"},"Usage"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"pricing-acceptance <moveCodeOrID>")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"pricing-acceptance <moveCodeOrID> api.stg.move.mil")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"pricing-acceptance <moveCodeOrID> api.stg.move.mil proof_of_service_docs.pdf")),(0,i.kt)("p",null,"After calling the tool, you will be prompted to include a path to a payload for the service item you wish to price."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'{3,4} title="Example output:"',"{3,4}":!0,title:'"Example','output:"':!0},'{\n  "body": {\n    "moveTaskOrderID": "9c7b255c-2981-4bf8-839f-61c7458e2b4d",\n    "mtoShipmentID": "0d3a0a52-a9fc-4a7e-bbf4-80f762da44d8",\n    "modelType": "MTOServiceItemShuttle",\n    "reServiceCode": "DOSHUT",\n    "estimatedWeight": 1400,\n    "actualWeight": 1400,\n    "reason": "Explanation of why a shuttle service is required",\n    "description": "Description of shuttling"\n  }\n}\n')),(0,i.kt)("p",null,"The CLI will output the ",(0,i.kt)("inlineCode",{parentName:"p"},"moveCodeOrID")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"mtoShipmentID")," that should be use in the payload"),(0,i.kt)("p",null,"The CLI will create a payment request for the service item provided. You will be prompted to login as a TIO and approve the payment request. Once approved, you can resume the CLI which will then generate an EDI."),(0,i.kt)("h2",{id:"creating-a-new-mto-with-shipments"},"Creating a new MTO with shipments"),(0,i.kt)("p",null,"Currently there is a temporary converter that will convert PPMs to HHGs for use in testing on staging. It is not enabled in production. The converter code is in ",(0,i.kt)("inlineCode",{parentName:"p"},"pkg/services/converthelper/convert.go"),". This allows us to create a new MTO and it will automatically create two shipments, a line haul and a short haul."),(0,i.kt)("h3",{id:"1-create-a-new-ppm"},"1. Create a new PPM"),(0,i.kt)("p",null,"I'm not sure if you need to create a new service member each time but I think PPMs are limited to one per SM."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Go to http://milmovelocal:3000/"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Create a new milmove user")," and Sign in the local sign in feature"),(0,i.kt)("li",{parentName:"ul"},"Create a new PPM move request",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Use the ",(0,i.kt)("a",{parentName:"li",href:"https://docs.google.com/spreadsheets/d/1u1NO_ZWvKJc2ylOSF5-4mcm6Eg5X2zu7c_P-X4lDrE4/edit#gid=524168919"},"fake names spreadsheet")," for names and addresses"),(0,i.kt)("li",{parentName:"ul"},"Go through the whole thing and sign the form to submit the move"))),(0,i.kt)("li",{parentName:"ul"},"Submit the move")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/940173/86168467-16b14600-bacd-11ea-9e31-041f2926d41a.png",alt:"Successfully Submitted Screenshot"})),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"For staging the only difference is to visit ",(0,i.kt)("a",{parentName:"p",href:"https://my.stg.move.mil/"},"https://my.stg.move.mil/")," and click ",(0,i.kt)("inlineCode",{parentName:"p"},"Sign in")," and then ",(0,i.kt)("inlineCode",{parentName:"p"},"Create a new account")," instead of local sign in.")),(0,i.kt)("h3",{id:"2-approve-hhg-shipments-and-send-to-prime"},"2. Approve HHG shipments and send to prime"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("em",{parentName:"p"},"For staging after creating a PPM move it is automatically converted to an HHG\nbecause staging has ",(0,i.kt)("inlineCode",{parentName:"em"},"FEATURE_FLAG_CONVERT_PPMS_TO_GHC")," on. But to see these HHG\nmoves you have to log into the ",(0,i.kt)("a",{parentName:"em",href:"https://office.stg.move.mil/"},"https://office.stg.move.mil/")," with a user that has\nthe ",(0,i.kt)("inlineCode",{parentName:"em"},"TOO")," role. You can give yourself the ",(0,i.kt)("inlineCode",{parentName:"em"},"TOO")," role in the\n",(0,i.kt)("a",{parentName:"em",href:"https://admin.stg.move.mil/"},"https://admin.stg.move.mil/")," app."))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Sign into http://officelocal:3000/ as ",(0,i.kt)("inlineCode",{parentName:"li"},"too_role@office.mil (PPM office)")," via the local sign in feature"),(0,i.kt)("li",{parentName:"ul"},"See that the move is listed in the queue"),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("inlineCode",{parentName:"li"},"Customer Details Page Skeleton")," link"),(0,i.kt)("li",{parentName:"ul"},"See that an HHG_LONGHAUL_DOMESTIC and HHG_SHORTHAUL_DOMESTIC shipments are added"),(0,i.kt)("li",{parentName:"ul"},"Approve each and see that the appropriate service items are added for each. (",(0,i.kt)("a",{parentName:"li",href:"https://docs.google.com/spreadsheets/d/1zeS5J2LVd_cyB2TW2rQPu1hHqKSXT-UY7RpUzfvTi0k/edit#gid=0"},"See this spreadsheet")," to confirm what those service items should be)"),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("inlineCode",{parentName:"li"},"Send to Prime")," at the bottom of the page to make it available to the prime.")),(0,i.kt)("p",null,"At this point you should be able to move on to setting up a payment request."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("em",{parentName:"p"},"The MTO Shipments that are created will have ",(0,i.kt)("inlineCode",{parentName:"em"},"PrimeEstimatedWeight")," set to\n",(0,i.kt)("inlineCode",{parentName:"em"},"4096")," for each shipment. This is done because of the restrictions on when the\nprime can set estimated weight making it extra difficult to setup examples in\nstaging."))),(0,i.kt)("h2",{id:"adding-service-items-to-a-shipment"},"Adding Service Items to a Shipment"),(0,i.kt)("p",null,"Use the appropriate payload and create file to add service items to the shipment. Some examples are below, or ",(0,i.kt)("a",{parentName:"p",href:"https://redocly.github.io/redoc/?url=https://raw.githubusercontent.com/transcom/mymove/main/swagger/prime.yaml#operation/createMTOServiceItem"},"see reDoc createMTOServiceItem")," for more help."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --cac --hostname api.stg.move.mil --port 443 create-mto-service-item --filename create_payload.json | jq\n")),(0,i.kt)("h3",{id:"adding-crating"},"Adding Crating"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:"{3-4,19-20}","{3-4,19-20}":!0},'{\n    "body" : {\n        "moveTaskOrderID": "<enter UUID>",\n        "mtoShipmentID": "<enter UUID>",\n        "modelType": "MTOServiceItemDomesticCrating",\n        "reServiceCode": "DCRT",\n        "item": {\n            "type": "ITEM",\n            "length": 1000,\n            "width": 1000,\n            "height": 1000\n        },\n        "crate": {\n            "type": "CRATE",\n            "length": 1100,\n            "width": 1100,\n            "height": 1100\n        },\n        "description": "<enter drescription>",\n        "reason": "<enter reason>"\n    }\n}\n')),(0,i.kt)("h3",{id:"add-shuttling"},"Add Shuttling"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:"{4-5,8-9}","{4-5,8-9}":!0},'{\n    "body" : {\n        "modelType": "MTOServiceItemShuttle",\n        "moveTaskOrderID": "<YOUR MOVE ID>",\n        "mtoShipmentID": "<YOUR SHIPMENT ID>",\n        "status": "SUBMITTED",\n        "reServiceCode": "DOSHUT",\n        "description": "description",\n        "reason": "reason",\n        "estimatedWeight": 4200\n    }\n}\n')),(0,i.kt)("h2",{id:"creating-a-payment-request"},"Creating a Payment request"),(0,i.kt)("p",null,"It may be helpful to check out the API docs, see ",(0,i.kt)("a",{parentName:"p",href:"https://redocly.github.io/redoc/?url=https://raw.githubusercontent.com/transcom/mymove/main/swagger/prime.yaml"},"Milmove Prime API Documentation")," and ",(0,i.kt)("a",{parentName:"p",href:"https://redocly.github.io/redoc/?url=https://raw.githubusercontent.com/transcom/mymove/main/swagger/support.yaml"},"Milmove Support API Documentation"),". Also further information in ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/transcom/prime_api_deliverable"},"this repo"),"."),(0,i.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"#creating-a-new-mto-with-shipments"},"See above")," for instructions on how to you set these up via the UI"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"MTO has to be made available to the prime"),(0,i.kt)("li",{parentName:"ul"},"MTO has an approved shipment"),(0,i.kt)("li",{parentName:"ul"},"MTOShipment has ",(0,i.kt)("inlineCode",{parentName:"li"},"scheduledPickupDate")," set to ",(0,i.kt)("em",{parentName:"li"},"at least 10 days")," after TOO approved date"),(0,i.kt)("li",{parentName:"ul"},"MTOShipment has ",(0,i.kt)("inlineCode",{parentName:"li"},"actualPickupDate"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"primeEstimatedWeight"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"primeActualWeight")," set",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"primeEstimatedWeight")," has restrictions:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Cannot be edited once set"),(0,i.kt)("li",{parentName:"ul"},"Cannot be set if scheduledPickupDate is too close to TOO approved date")))))),(0,i.kt)("h3",{id:"add-weights-to-the-shipment"},"Add weights to the shipment"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("em",{parentName:"p"},"The ",(0,i.kt)("inlineCode",{parentName:"em"},"PrimeEstimatedWeight")," will be set already if using the PPM to HHG\nconverter as instructed ",(0,i.kt)("a",{parentName:"em",href:"#creating-a-new-mto-with-shipments"},"above"),". If it is\nyou won't need to set it again, in fact you can't adjust it once set so omit it\nfrom the payloads"))),(0,i.kt)("p",null,"To update a shipment with estimated and actual weights get the ",(0,i.kt)("inlineCode",{parentName:"p"},"eTag")," for the shipment. The first id is for the MTO, and the second is for the MTOShipment."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Development")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'prime-api-client --insecure fetch-mto-updates | jq \'map(select(.id == "da3f34cc-fb94-4e0b-1c90-ba3333cb7791")) | .[0] | .mtoShipments | map(select(.id == "b4306be8-146f-482c-b4a2-8432d4b970ca")) | .[0] | .eTag\'\n')),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Staging")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'prime-api-client --cac --hostname api.stg.move.mil --port 443 fetch-mto-updates | jq \'map(select(.id == "da3f34cc-fb94-4e0b-1c90-ba3333cb7791")) | .[0] | .mtoShipments | map(select(.id == "b4306be8-146f-482c-b4a2-8432d4b970ca")) | .[0] | .eTag\'\n')),(0,i.kt)("p",null,"Then use that ",(0,i.kt)("inlineCode",{parentName:"p"},"eTag")," in the following payload, which you should save in ",(0,i.kt)("inlineCode",{parentName:"p"},"update_mto_shipment.json"),". This example includes the additional fields of ",(0,i.kt)("inlineCode",{parentName:"p"},"scheduledPickupDate")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"actualPickupDate"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="update_mto_shipment.json"',title:'"update_mto_shipment.json"'},'{\n  "mtoShipmentID": "b4306be8-146f-482c-b4a2-8432d4b970ca",\n  "If-Match": "MjAyMC0wNi0wOVQwNTo1ODowMC44MjA3NDha",\n  "body": {\n    "scheduledPickupDate": "2020-11-22",\n    "actualPickupDate": "2020-11-22"\n  }\n}\n')),(0,i.kt)("p",null,"Now you can update the shipment"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Development")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --insecure update-mto-shipment --filename update_mto_shipment.json | jq\n")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Staging")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --cac --hostname api.stg.move.mil --port 443 update-mto-shipment --filename update_mto_shipment.json | jq\n")),(0,i.kt)("p",null,"Once the ",(0,i.kt)("inlineCode",{parentName:"p"},"scheduledPickupDate")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"actualPickupDate")," are set you will need to repeat the above steps with the following payload to update the mto shipment again to add the weights."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "mtoShipmentID": "b4306be8-146f-482c-b4a2-8432d4b970ca",\n  "If-Match": "MjAyMC0wNi0wOVQwNTo1ODowMC44MjA3NDha",\n  "body": {\n    "primeEstimatedWeight": 1000,\n    "primeActualWeight": 3000\n  }\n}\n')),(0,i.kt)("h3",{id:"add-sit-related-service-items"},"Add SIT-related service items"),(0,i.kt)("h4",{id:"domestic-destination-first-day-sit"},"Domestic Destination First Day SIT"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "body": {\n    "moveTaskOrderID": "<insert MTO ID>",\n    "mtoShipmentID": "<insert shipment ID>",\n    "modelType": "MTOServiceItemDestSIT",\n    "reServiceCode": "DDFSIT",\n    "timeMilitary1": "1705Z",\n    "firstAvailableDeliveryDate1": "2021-01-31",\n    "timeMilitary2": "0719Z",\n    "firstAvailableDeliveryDate2": "2021-02-03",\n    "sitEntryDate": "2021-01-12"\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Development")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --insecure create-mto-service-item --filename create_ddfsit.json | jq\n")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Staging")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --cac --hostname api.stg.move.mil --port 443 create-mto-service-item --filename create_ddfsit.json | jq\n")),(0,i.kt)("h4",{id:"domestic-origin-first-day-sit"},"Domestic Origin First Day SIT"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "body": {\n    "moveTaskOrderID": "<insert MTO ID>",\n    "mtoShipmentID": "<insert shipment ID>",\n    "modelType": "MTOServiceItemOriginSIT",\n    "reServiceCode": "DOFSIT",\n    "sitPostalCode": "30907",\n    "reason": "my address changed",\n    "sitEntryDate": "2021-01-13"\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Development")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --insecure create-mto-service-item --filename create_dofsit.json | jq\n")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Staging")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --cac --hostname api.stg.move.mil --port 443 create-mto-service-item --filename create_dofsit.json | jq\n")),(0,i.kt)("h3",{id:"create-a-payment-request"},"Create a Payment Request"),(0,i.kt)("p",null,"You need to be sure that the MTO and MTO Shipment have the details needed for pricing the Service Items included in the payment request. For example to price a Domestic Linehaul service item the MTO Shipment will need both estimated and actual weight set. See above on how to update the shipment."),(0,i.kt)("p",null,"To create a payment request add the following JSON to a file called ",(0,i.kt)("inlineCode",{parentName:"p"},"create_payment_request.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "body": {\n    "isFinal": false,\n    "moveTaskOrderID": "da3f34cc-fb94-4e0b-1c90-ba3333cb7791",\n    "serviceItems": [\n      {\n        "id": "9db1bf43-0964-44ff-8384-3297951f6781"\n      }\n    ]\n  }\n}\n')),(0,i.kt)("p",null,"Then execute the command to create the payment request."),(0,i.kt)("h4",{id:"development"},"Development"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --insecure create-payment-request --filename create_payment_request.json | jq\n")),(0,i.kt)("h4",{id:"staging"},"Staging"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --cac --hostname api.stg.move.mil --port 443 create-payment-request --filename create_payment_request.json | jq\n")),(0,i.kt)("h3",{id:"create-a-payment-request-upload"},"Create a Payment Request Upload"),(0,i.kt)("p",null,"TBD"),(0,i.kt)("h4",{id:"development-1"},"Development"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'prime-api-client --insecure  create-upload --paymentRequestID "a6268f43-fcf9-4b71-aa59-ea2f55aeb324" --filename "/Users/jacquelinemckinney/Documents/mymove/pcs orders/dd1614_pcs.pdf" | jqprime-api-client --insecure create-payment-request --filename create_payment_request.json | jq\n')),(0,i.kt)("h4",{id:"staging-1"},"Staging"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'prime-api-client --cac --hostname api.stg.move.mil --port 443 create-upload --paymentRequestID "a6268f43-fcf9-4b71-aa59-ea2f55aeb324" --filename "/Users/jacquelinemckinney/Documents/mymove/pcs orders/dd1614_pcs.pdf" | jq\n')),(0,i.kt)("h2",{id:"verifying-pricing"},"Verifying Pricing"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Since we cannot run queries on staging you will need to run the below queries\nlocally. However, you can load the staging rate data into your database locally\nby running ",(0,i.kt)("inlineCode",{parentName:"p"},"make run_staging_migrations")," and then running the queries in\n",(0,i.kt)("inlineCode",{parentName:"p"},"deployed_migrations")," database.")),(0,i.kt)("h3",{id:"domestic-short-haul-dsh"},"Domestic Short Haul (DSH)"),(0,i.kt)("p",null,"Formula for price calculation ",(0,i.kt)("inlineCode",{parentName:"p"},"priceInCents = (Weight Billed Actual / 100.0) * distanceInMiles * rateInCents * escalationCompounded")," round to nearest cent."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"distanceInMiles")," is obtained from the ",(0,i.kt)("inlineCode",{parentName:"p"},"DistanceZip5")," field in\n",(0,i.kt)("inlineCode",{parentName:"p"},"paymentServiceItemsParams")," on the payment request. ",(0,i.kt)("inlineCode",{parentName:"p"},"Weight Billed Actual")," is\nalso found in ",(0,i.kt)("inlineCode",{parentName:"p"},"paymentServiceItemsParams"),".")),(0,i.kt)("p",null,"To get the rate and ",(0,i.kt)("inlineCode",{parentName:"p"},"escalationCompounded")," run the following query filling in the service item params for your payment request."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql",metastring:"{6-10}","{6-10}":!0},"select price_cents, escalation_compounded from re_domestic_service_area_prices dsap\n    inner join re_domestic_service_areas sa on dsap.domestic_service_area_id = sa.id\n    inner join re_services on dsap.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dsap.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where sa.service_area = '076'\n        and re_services.code = 'DSH'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dsap.is_peak_period = true\n        and '2020-06-29' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-long-haul-dlh"},"Domestic Long Haul (DLH)"),(0,i.kt)("p",null,"Formula for price calculation ",(0,i.kt)("inlineCode",{parentName:"p"},"priceInCents = ((Weight Billed Actual / 100.0) * distanceInMiles * rateInMillicents * escalationCompounded) / 1000")," round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select price_millicents, escalation_compounded\n    from re_domestic_linehaul_prices dlp\n    inner join re_contracts c on dlp.contract_id = c.id\n    inner join re_contract_years cy on c.id = cy.contract_id\n    inner join re_domestic_service_areas dsa on dlp.domestic_service_area_id = dsa.id\n    where c.code = 'TRUSS_TEST'\n        and '2020-06-29' between cy.start_date and cy.end_date\n        and dlp.is_peak_period = true\n        and 3000 between dlp.weight_lower and dlp.weight_upper\n        and 2376 between dlp.miles_lower and dlp.miles_upper\n        and dsa.service_area = '076';\n")),(0,i.kt)("h3",{id:"domestic-destination-price-ddp"},"Domestic Destination Price (DDP)"),(0,i.kt)("p",null,"Formula for price calculation ",(0,i.kt)("inlineCode",{parentName:"p"},"priceInCents = (Weight Billed Actual / 100.0) * rateInCents * escalationCompounded")," round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select price_cents, escalation_compounded from re_domestic_service_area_prices dsap\n    inner join re_domestic_service_areas sa on dsap.domestic_service_area_id = sa.id\n    inner join re_services on dsap.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dsap.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where sa.service_area = '080'\n        and re_services.code = 'DDP'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dsap.is_peak_period = true\n        and '2020-06-26' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-origin-price-dop"},"Domestic Origin Price (DOP)"),(0,i.kt)("p",null,"Formula for price calculation ",(0,i.kt)("inlineCode",{parentName:"p"},"priceInCents = (Weight Billed Actual / 100.0) * rateInCents * escalationCompounded")," round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select price_cents, escalation_compounded from re_domestic_service_area_prices dsap\n    inner join re_domestic_service_areas sa on dsap.domestic_service_area_id = sa.id\n    inner join re_services on dsap.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dsap.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where sa.service_area = '080'\n        and re_services.code = 'DOP'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dsap.is_peak_period = true\n        and '2020-06-26' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-packing-price-dpk"},"Domestic Packing Price (DPK)"),(0,i.kt)("p",null,"Formula for price calculation ",(0,i.kt)("inlineCode",{parentName:"p"},"priceInCents = (Weight Billed Actual / 100.0) * rateInCents * escalationCompounded")," round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select price_cents, escalation_compounded from re_domestic_other_prices dop\n    inner join re_services on dop.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dop.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where re_services.code = 'DPK'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dop.is_peak_period = true\n        and dop.schedule = 3\n        and '2020-07-22' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-unpacking-price-dupk"},"Domestic Unpacking Price (DUPK)"),(0,i.kt)("p",null,"Formula for price calculation ",(0,i.kt)("inlineCode",{parentName:"p"},"priceInCents = (Weight Billed Actual / 100.0) * rateInCents * escalationCompounded")," round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select price_cents, escalation_compounded from re_domestic_other_prices dop\n    inner join re_services on dop.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dop.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where re_services.code = 'DUPK'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dop.is_peak_period = true\n        and dop.schedule = 3\n        and '2020-07-22' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"fuel-surcharge-price-fsc"},"Fuel Surcharge Price (FSC)"),(0,i.kt)("p",null,"Formula for price calculation"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"(",(0,i.kt)("inlineCode",{parentName:"li"},"weekly national diesel fuel price")," - 2.50) x 100 = ",(0,i.kt)("inlineCode",{parentName:"li"},"price difference in cents")),(0,i.kt)("li",{parentName:"ol"},"Determine the ",(0,i.kt)("inlineCode",{parentName:"li"},"weight based distance multiplier"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"For shipments up to 5,000 lbs, the amount is $0.000417 per mile."),(0,i.kt)("li",{parentName:"ul"},"For shipments between 5,001 and 10,000 lbs, the amount is $0.0006255 per mile."),(0,i.kt)("li",{parentName:"ul"},"For shipments 10,001 to 24,000, the amount is $0.000834 per mile."),(0,i.kt)("li",{parentName:"ul"},"For shipments over 24,001 lbs, the amount is $0.00139 per mile."))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"weight based distance multiplier")," x ",(0,i.kt)("inlineCode",{parentName:"li"},"distance")," = ",(0,i.kt)("inlineCode",{parentName:"li"},"fuel surcharge multiplier")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"price difference in cents")," x ",(0,i.kt)("inlineCode",{parentName:"li"},"fuel surcharge multiplier")," = ",(0,i.kt)("inlineCode",{parentName:"li"},"fuel surcharge price"))),(0,i.kt)("p",null,"All information for calculating the FSC and the FSC price can be verified by checking the params that are returned upon successfully creating a payment request."),(0,i.kt)("h3",{id:"domestic-destination-or-origin-first-day-sit-ddfsit-or-dofsit"},"Domestic Destination or Origin First Day SIT (DDFSIT or DOFSIT)"),(0,i.kt)("p",null,"note: edit ",(0,i.kt)("inlineCode",{parentName:"p"},"re_services.code = 'DDFSIT'")," for ",(0,i.kt)("inlineCode",{parentName:"p"},"DDFSIT")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"DOFSIT")),(0,i.kt)("p",null,"Formula for price calculation ",(0,i.kt)("inlineCode",{parentName:"p"},"priceInCents = (Weight Billed Actual / 100.0) * rateInCents * escalationCompounded")," round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select price_cents, escalation_compounded from re_domestic_service_area_prices dsap\n   inner join re_domestic_service_areas sa on dsap.domestic_service_area_id = sa.id\n   inner join re_services on dsap.service_id = re_services.id\n   inner join re_contracts on re_contracts.id = dsap.contract_id\n   inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n   where sa.service_area = '080'\n    and re_services.code = 'DDFSIT'\n    and re_contracts.code = 'TRUSS_TEST'\n    and dsap.is_peak_period = true\n    and '2020-06-26' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-destination-or-origin-sit-additional-days-ddasit-or-doasit"},"Domestic Destination or Origin SIT Additional Days (DDASIT or DOASIT)"),(0,i.kt)("p",null,"note: edit ",(0,i.kt)("inlineCode",{parentName:"p"},"re_services.code = 'DDASIT'")," for ",(0,i.kt)("inlineCode",{parentName:"p"},"DDASIT")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"DOASIT")),(0,i.kt)("p",null,"priceInCents = (Weight Billed Actual / 100.0) ",(0,i.kt)("em",{parentName:"p"}," number of days ")," rateInCents * escalationCompounded round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select price_cents, escalation_compounded from re_domestic_service_area_prices dsap\n    inner join re_domestic_service_areas sa on dsap.domestic_service_area_id = sa.id\n    inner join re_services on dsap.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dsap.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where sa.service_area = '781'\n        and re_services.code = 'DDASIT'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dsap.is_peak_period = false\n        and '2021-02-04' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-destination-delivery-or-origin-pickup-sit-dddsit-or-dopsit"},"Domestic Destination Delivery or Origin Pickup SIT (DDDSIT or DOPSIT)"),(0,i.kt)("p",null,"note: edit ",(0,i.kt)("inlineCode",{parentName:"p"},"re_services.code = 'DDDSIT'")," for ",(0,i.kt)("inlineCode",{parentName:"p"},"DDDSIT")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"DOPSIT")),(0,i.kt)("p",null,"note: for details about setting up delivery/pickup SIT service items and example ZIP codes for testing each of these scenarios, see ",(0,i.kt)("a",{parentName:"p",href:"/mymove-docs/docs/backend/testing/testing-payment-requests-for-domestic-sit-service-items"},"this page"),"."),(0,i.kt)("p",null,"If zip3 to same zip3, use the ",(0,i.kt)("a",{parentName:"p",href:"/mymove-docs/docs/backend/testing/acceptance-testing-payment-requests#domestic-short-haul-dsh"},"domestic shorthaul")," calculation."),(0,i.kt)("p",null,"If zip3 to different zip3 and > 50 miles, use the ",(0,i.kt)("a",{parentName:"p",href:"/mymove-docs/docs/backend/testing/acceptance-testing-notifications#domestic-long-haul-dlh"},"domestic linehaul")," calculation."),(0,i.kt)("p",null,"If zip3 to different zip3 and <= 50 miles, use the following:"),(0,i.kt)("p",null,"Formula for price calculation ",(0,i.kt)("inlineCode",{parentName:"p"},"priceInCents = (Weight Billed Actual / 100.0) * rateInCents * escalationCompounded")," round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select price_cents, escalation_compounded from re_domestic_other_prices dop\n    inner join re_services on dop.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dop.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where re_services.code = 'DDDSIT'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dop.is_peak_period = true\n        and dop.schedule = 3\n        and '2020-07-22' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-destination-shuttling-ddshut"},"Domestic Destination Shuttling (DDSHUT)"),(0,i.kt)("p",null,"Formula for price calculation priceInCents = (Weight Billed Actual / 100.0) ",(0,i.kt)("em",{parentName:"p"}," rateInCents ")," escalationCompounded round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select per_unit_cents, escalation_compounded from re_domestic_accessorial_prices dap\n    inner join re_services on dap.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dap.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where re_services.code = 'DDSHUT'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dap.services_schedule = 3\n        and '2020-07-22' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-origin-shuttling-doshut"},"Domestic Origin Shuttling (DOSHUT)"),(0,i.kt)("p",null,"Formula for price calculation priceInCents = (Weight Billed Actual / 100.0) ",(0,i.kt)("em",{parentName:"p"}," rateInCents ")," escalationCompounded round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select per_unit_cents, escalation_compounded from re_domestic_accessorial_prices dap\n    inner join re_services on dap.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dap.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where re_services.code = 'DOSHUT'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dap.services_schedule = 3\n        and '2020-07-22' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-crating-dcrt"},"Domestic Crating (DCRT)"),(0,i.kt)("p",null,"Formula for price calculation priceInCents = cubicFeetBilled ",(0,i.kt)("em",{parentName:"p"}," rateInCents ")," escalationCompounded round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select per_unit_cents, escalation_compounded from re_domestic_accessorial_prices dap\n    inner join re_services on dap.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dap.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where re_services.code = 'DCRT'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dap.services_schedule = 3\n        and '2020-07-22' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h3",{id:"domestic-uncrating-ducrt"},"Domestic Uncrating (DUCRT)"),(0,i.kt)("p",null,"Formula for price calculation priceInCents = cubicFeetBilled ",(0,i.kt)("em",{parentName:"p"}," rateInCents ")," escalationCompounded round to nearest cent"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select per_unit_cents, escalation_compounded from re_domestic_accessorial_prices dap\n    inner join re_services on dap.service_id = re_services.id\n    inner join re_contracts on re_contracts.id = dap.contract_id\n    inner join re_contract_years on re_contracts.id = re_contract_years.contract_id\n    where re_services.code = 'DUCRT'\n        and re_contracts.code = 'TRUSS_TEST'\n        and dap.services_schedule = 3\n        and '2020-07-22' between re_contract_years.start_date and re_contract_years.end_date;\n")),(0,i.kt)("h2",{id:"generate-edi-via-support-api"},"Generate EDI via Support API"),(0,i.kt)("h3",{id:"prerequisites-1"},"Prerequisites"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"#creating-a-payment-request"},"See above")," for instructions on how to create a payment request. Also you can run ",(0,i.kt)("inlineCode",{parentName:"p"},"fetch-mto-updates")," to find an existing payment request to use for generating an EDI."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"MTO with a payment request created")),(0,i.kt)("h3",{id:"generate-edi-via-support-api-1"},"Generate EDI via Support API"),(0,i.kt)("p",null,"To generate an EDI add the following JSON to a file called ",(0,i.kt)("inlineCode",{parentName:"p"},"get_payment_request_edi.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="get_payment_request_edi.json"',title:'"get_payment_request_edi.json"'},'{\n  "paymentRequestID": "6ed3829c-c83e-4ffd-8fcc-a7025638266f"\n}\n')),(0,i.kt)("p",null,"Then execute the command to create the payment request."),(0,i.kt)("h4",{id:"development-2"},"Development"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --insecure support-get-payment-request-edi --filename get_payment_request_edi.json | jq -r '.edi'\n")),(0,i.kt)("h4",{id:"staging-2"},"Staging"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --cac --hostname api.stg.move.mil --port 443  support-get-payment-request-edi --filename get_payment_request_edi.json | jq -r '.edi'\n")),(0,i.kt)("h2",{id:"move-task-order-actions"},"Move Task Order actions"),(0,i.kt)("h3",{id:"create-an-mto-shipment-via-prime-api"},"Create an MTO Shipment via prime API"),(0,i.kt)("p",null,"If you need to create a new MTO Shipment create a file named ",(0,i.kt)("inlineCode",{parentName:"p"},"create_mto_shipment.json")," with the following data"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="create_mto_shipment.json"',title:'"create_mto_shipment.json"'},'{\n  "body": {\n    "moveTaskOrderID": "da3f34cc-fb94-4e0b-1c90-ba3333cb7791",\n    "shipmentType": "HHG",\n    "requestedPickupDate": "2020-06-08",\n    "customerRemarks": "special one handle with care",\n    "pickupAddress": {\n      "city": "Beverly Hills",\n      "country": "US",\n      "postalCode": "90210",\n      "state": "CA",\n      "streetAddress1": "123 Any Street",\n      "streetAddress2": "P.O. Box 12345",\n      "streetAddress3": "c/o Some Person"\n    },\n    "destinationAddress": {\n      "city": "Fairfield",\n      "country": "US",\n      "postalCode": "94535",\n      "state": "CA",\n      "streetAddress1": "987 Any Avenue",\n      "streetAddress2": "P.O. Box 9876",\n      "streetAddress3": "c/o Some Person"\n    },\n    "agents": [\n      {\n        "firstName": "James",\n        "lastName": "Semaj",\n        "email": "jsemaj@example.com",\n        "phone": "234-555-1234",\n        "agentType": "RELEASING_AGENT"\n      }\n    ],\n    "pointOfContact": "string",\n    "mtoServiceItems": []\n  }\n}\n')),(0,i.kt)("p",null,"Execute the following command to create the shipment"),(0,i.kt)("h4",{id:"development-3"},"Development"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --insecure create-mto-shipment --filename create_mto_shipment.json | jq\n")),(0,i.kt)("h4",{id:"staging-3"},"Staging"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --cac --hostname api.stg.move.mil --port 443 create-mto-shipment --filename create_mto_shipment.json\n")),(0,i.kt)("h3",{id:"approve-mto-shipment"},"Approve MTO Shipment"),(0,i.kt)("h4",{id:"via-too-ui"},"Via TOO UI"),(0,i.kt)("p",null,"To approve an MTO shipment use the following steps:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Login to the office app ",(0,i.kt)("a",{parentName:"li",href:"https://office.stg.move.mil/"},"https://office.stg.move.mil/")," as a TOO"),(0,i.kt)("li",{parentName:"ul"},"Head over to the skeleton list of customer moves ",(0,i.kt)("a",{parentName:"li",href:"https://office.stg.move.mil/too/customer-moves"},"https://office.stg.move.mil/too/customer-moves")),(0,i.kt)("li",{parentName:"ul"},"Select a move, a little trial and error to find one with an MTO"),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("inlineCode",{parentName:"li"},"Approve")," next to the shipment. This will add the appropriate service items")),(0,i.kt)("h3",{id:"make-mto-available-to-the-prime"},"Make MTO available to the prime"),(0,i.kt)("p",null,"There are two ways to do this"),(0,i.kt)("h4",{id:"via-too-ui-1"},"Via TOO UI"),(0,i.kt)("p",null,"To make an MTO available to the prime use the following steps:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Login to the office app ",(0,i.kt)("a",{parentName:"li",href:"https://office.stg.move.mil/"},"https://office.stg.move.mil/")," as a TOO"),(0,i.kt)("li",{parentName:"ul"},"Head over to the skeleton list of customer moves ",(0,i.kt)("a",{parentName:"li",href:"https://office.stg.move.mil/too/customer-moves"},"https://office.stg.move.mil/too/customer-moves")),(0,i.kt)("li",{parentName:"ul"},"Select a move, a little trial and error to find one with an MTO"),(0,i.kt)("li",{parentName:"ul"},"Click ",(0,i.kt)("inlineCode",{parentName:"li"},"Send to Prime")," at the bottom")),(0,i.kt)("h4",{id:"via-support-api"},"Via support api"),(0,i.kt)("p",null,"If needed you can make a MTO available to the prime via the API you can save the following payload to a file ",(0,i.kt)("inlineCode",{parentName:"p"},"avail_to_prime.json"),". ",(0,i.kt)("em",{parentName:"p"},"Note")," this makes use of the support API."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "moveTaskOrderID": "da3f34cc-fb94-4e0b-1c90-ba3333cb7791",\n  "If-Match": "MjAyMC0wNi0wOVQwNTo0MzozMC43MzA5Nzla"\n}\n')),(0,i.kt)("p",null,"Then run the following command"),(0,i.kt)("h4",{id:"development-4"},"Development"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --insecure support-make-move-task-order-available --filename avail_to_prime.json | jq'\n")),(0,i.kt)("h4",{id:"staging-4"},"Staging"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --cac --hostname api.stg.move.mil --port 443 support-make-move-task-order-available --filename avail_to_prime.json | jq'\n")),(0,i.kt)("h2",{id:"issues"},"Issues"),(0,i.kt)("h3",{id:"errors-during-service-item-param-lookups-dont-bubble-up"},"Errors during service item param lookups don't bubble up"),(0,i.kt)("p",null,"When creating a payment request you may get an empty payload. This is usually caused by an exception who's message is not being propagated up to the response. There is an open story to fix this, but if it happens during acceptance you should look at the logs to see what went wrong."),(0,i.kt)("h2",{id:"searching-for-errors-in-staging"},"Searching For Errors in Staging"),(0,i.kt)("p",null,"This can be done in CloudWatch using the Log Insights (See ",(0,i.kt)("a",{parentName:"p",href:"https://dp3.atlassian.net/l/c/UKR6fUhk"},"this doc")," for details), or more easily with the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/trussworks/ecs-service-logs"},"ecs-service-logs tool"),". If you have a ",(0,i.kt)("inlineCode",{parentName:"p"},"instance")," in the error message you can use that as the ",(0,i.kt)("inlineCode",{parentName:"p"},"milmove_trace_id")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Example error response:"',title:'"Example',error:!0,'response:"':!0},'{\n  "Payload": {\n    "detail": "An internal server error has occurred",\n    "instance": "4dacdb9e-0063-44c7-aa21-ebed1e8c221b",\n    "title": "Internal Server Error"\n  }\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"aws-vault exec transcom-gov-milmove-stg -- ecs-service-logs show -s app-client-tls -e stg 'milmove_trace_id=4dacdb9e-0063-44c7-aa21-ebed1e8c221b' | jq .\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Sample output:"',title:'"Sample','output:"':!0},'[\n  {\n    "level": "info",\n    "ts": "2020-06-17T18:45:48.516Z",\n    "caller": "primeapi/payment_request.go:39",\n    "msg": "primeapi.CreatePaymentRequestHandler info",\n    "git_branch": "main",\n    "git_commit": "71969d2e81f4fb10c5333bf9f152430541a06681",\n    "ecs_cluster": "arn:aws:ecs:us-west-2:923914045601:cluster/app-staging",\n    "ecs_task_def_family": "app-client-tls-staging",\n    "ecs_task_def_revision": "2588",\n    "milmove_trace_id": "4dacdb9e-0063-44c7-aa21-ebed1e8c221b",\n    "pointOfContact": ""\n  },\n  {\n    "level": "error",\n    "ts": "2020-06-17T18:45:49.130Z",\n    "caller": "primeapi/payment_request.go:81",\n    "msg": "Error creating payment request",\n    "git_branch": "main",\n    "git_commit": "71969d2e81f4fb10c5333bf9f152430541a06681",\n    "ecs_cluster": "arn:aws:ecs:us-west-2:923914045601:cluster/app-staging",\n    "ecs_task_def_family": "app-client-tls-staging",\n    "ecs_task_def_revision": "2588",\n    "milmove_trace_id": "4dacdb9e-0063-44c7-aa21-ebed1e8c221b",\n    "error": "Failed to create service item param for param key <ServiceAreaOrigin>  MTO ID <07b3adf0-1c53-40d0-becc-b157828d5dbd> paymentRequestID <00000000-0000-0000-0000-000000000000> MTO Service item ID <b68f3e45-acbc-48ae-b4a3-6fa34f781b50> RE Service Item Code: <> Name: <> err: Failed to lookup ServiceParamValue for param key <ServiceAreaOrigin>  err:  failed ServiceParamValue ServiceAreaOriginLookup with error sql: no rows in result set",\n    "stacktrace": "github.com/transcom/mymove/pkg/handlers/primeapi.CreatePaymentRequestHandler.Handle\\n\\t/home/circleci/transcom/mymove/pkg/handlers/primeapi/payment_request.go:81\\ngithub.com/transcom/mymove/pkg/gen/primeapi/primeoperations/payment_requests.(*CreatePaymentRequest).ServeHTTP\\n\\t/home/circleci/transcom/mymove/pkg/gen/primeapi/primeoperations/payment_requests/create_payment_request.go:60\\ngithub.com/go-openapi/runtime/middleware.NewOperationExecutor.func1\\n\\t/home/circleci/go/pkg/mod/github.com/go-openapi/runtime@v0.19.15/middleware/operation.go:28\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/go-openapi/runtime/middleware.NewRouter.func1\\n\\t/home/circleci/go/pkg/mod/github.com/go-openapi/runtime@v0.19.15/middleware/router.go:77\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/go-openapi/runtime/middleware.Redoc.func1\\n\\t/home/circleci/go/pkg/mod/github.com/go-openapi/runtime@v0.19.15/middleware/redoc.go:72\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/go-openapi/runtime/middleware.Spec.func1\\n\\t/home/circleci/go/pkg/mod/github.com/go-openapi/runtime@v0.19.15/middleware/spec.go:46\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngoji%2eio.dispatch.ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/dispatch.go:17\\ngithub.com/felixge/httpsnoop.CaptureMetrics.func1\\n\\t/home/circleci/go/pkg/mod/github.com/felixge/httpsnoop@v1.0.1/capture_metrics.go:30\\ngithub.com/felixge/httpsnoop.CaptureMetricsFn\\n\\t/home/circleci/go/pkg/mod/github.com/felixge/httpsnoop@v1.0.1/capture_metrics.go:81\\ngithub.com/felixge/httpsnoop.CaptureMetrics\\n\\t/home/circleci/go/pkg/mod/github.com/felixge/httpsnoop@v1.0.1/capture_metrics.go:29\\ngithub.com/transcom/mymove/pkg/middleware.RequestLogger.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/request_logger.go:77\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.NoCache.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/no_cache.go:13\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/auth/authentication.PrimeAuthorizationMiddleware.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/auth/authentication/auth.go:205\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/auth/authentication.ClientCertMiddleware.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/auth/authentication/client_cert.go:61\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/auth.HostnameDetectorMiddleware.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/auth/hostname_detector.go:21\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngoji%2eio.(*Mux).ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/mux.go:74\\ngoji%2eio.dispatch.ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/dispatch.go:17\\ngithub.com/transcom/mymove/pkg/middleware.LimitBodySize.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/limit_body_size.go:15\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.SecurityHeaders.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/security_headers.go:28\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.Recovery.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/recovery.go:50\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.ContextLogger.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/context_logger.go:18\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.Trace.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/trace.go:29\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngoji%2eio.(*Mux).ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/mux.go:74\\ngoji%2eio.dispatch.ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/dispatch.go:17\\ngoji%2eio.(*Mux).ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/mux.go:74\\nnet/http.serverHandler.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2807\\nnet/http.(*conn).serve\\n\\t/usr/local/go/src/net/http/server.go:1895"\n  },\n  {\n    "level": "error",\n    "ts": "2020-06-17T18:45:49.130Z",\n    "caller": "primeapi/payment_request.go:106",\n    "msg": "Payment Request",\n    "git_branch": "main",\n    "git_commit": "71969d2e81f4fb10c5333bf9f152430541a06681",\n    "ecs_cluster": "arn:aws:ecs:us-west-2:923914045601:cluster/app-staging",\n    "ecs_task_def_family": "app-client-tls-staging",\n    "ecs_task_def_revision": "2588",\n    "milmove_trace_id": "4dacdb9e-0063-44c7-aa21-ebed1e8c221b",\n    "payload": {\n      "isFinal": false,\n      "moveTaskOrderID": "07b3adf0-1c53-40d0-becc-b157828d5dbd",\n      "serviceItems": [\n        {\n          "id": "b68f3e45-acbc-48ae-b4a3-6fa34f781b50",\n          "params": null\n        }\n      ]\n    },\n    "stacktrace": "github.com/transcom/mymove/pkg/handlers/primeapi.CreatePaymentRequestHandler.Handle\\n\\t/home/circleci/transcom/mymove/pkg/handlers/primeapi/payment_request.go:106\\ngithub.com/transcom/mymove/pkg/gen/primeapi/primeoperations/payment_requests.(*CreatePaymentRequest).ServeHTTP\\n\\t/home/circleci/transcom/mymove/pkg/gen/primeapi/primeoperations/payment_requests/create_payment_request.go:60\\ngithub.com/go-openapi/runtime/middleware.NewOperationExecutor.func1\\n\\t/home/circleci/go/pkg/mod/github.com/go-openapi/runtime@v0.19.15/middleware/operation.go:28\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/go-openapi/runtime/middleware.NewRouter.func1\\n\\t/home/circleci/go/pkg/mod/github.com/go-openapi/runtime@v0.19.15/middleware/router.go:77\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/go-openapi/runtime/middleware.Redoc.func1\\n\\t/home/circleci/go/pkg/mod/github.com/go-openapi/runtime@v0.19.15/middleware/redoc.go:72\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/go-openapi/runtime/middleware.Spec.func1\\n\\t/home/circleci/go/pkg/mod/github.com/go-openapi/runtime@v0.19.15/middleware/spec.go:46\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngoji%2eio.dispatch.ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/dispatch.go:17\\ngithub.com/felixge/httpsnoop.CaptureMetrics.func1\\n\\t/home/circleci/go/pkg/mod/github.com/felixge/httpsnoop@v1.0.1/capture_metrics.go:30\\ngithub.com/felixge/httpsnoop.CaptureMetricsFn\\n\\t/home/circleci/go/pkg/mod/github.com/felixge/httpsnoop@v1.0.1/capture_metrics.go:81\\ngithub.com/felixge/httpsnoop.CaptureMetrics\\n\\t/home/circleci/go/pkg/mod/github.com/felixge/httpsnoop@v1.0.1/capture_metrics.go:29\\ngithub.com/transcom/mymove/pkg/middleware.RequestLogger.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/request_logger.go:77\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.NoCache.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/no_cache.go:13\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/auth/authentication.PrimeAuthorizationMiddleware.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/auth/authentication/auth.go:205\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/auth/authentication.ClientCertMiddleware.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/auth/authentication/client_cert.go:61\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/auth.HostnameDetectorMiddleware.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/auth/hostname_detector.go:21\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngoji%2eio.(*Mux).ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/mux.go:74\\ngoji%2eio.dispatch.ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/dispatch.go:17\\ngithub.com/transcom/mymove/pkg/middleware.LimitBodySize.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/limit_body_size.go:15\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.SecurityHeaders.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/security_headers.go:28\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.Recovery.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/recovery.go:50\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.ContextLogger.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/context_logger.go:18\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngithub.com/transcom/mymove/pkg/middleware.Trace.func1.1\\n\\t/home/circleci/transcom/mymove/pkg/middleware/trace.go:29\\nnet/http.HandlerFunc.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2012\\ngoji%2eio.(*Mux).ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/mux.go:74\\ngoji%2eio.dispatch.ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/dispatch.go:17\\ngoji%2eio.(*Mux).ServeHTTP\\n\\t/home/circleci/go/pkg/mod/goji.io@v2.0.2+incompatible/mux.go:74\\nnet/http.serverHandler.ServeHTTP\\n\\t/usr/local/go/src/net/http/server.go:2807\\nnet/http.(*conn).serve\\n\\t/usr/local/go/src/net/http/server.go:1895"\n  },\n  {\n    "level": "info",\n    "ts": "2020-06-17T18:45:49.130Z",\n    "caller": "middleware/request_logger.go:85",\n    "msg": "Request",\n    "git_branch": "main",\n    "git_commit": "71969d2e81f4fb10c5333bf9f152430541a06681",\n    "ecs_cluster": "arn:aws:ecs:us-west-2:923914045601:cluster/app-stg",\n    "ecs_task_def_family": "app-client-tls-stg",\n    "ecs_task_def_revision": "2588",\n    "milmove_trace_id": "4dacdb9e-0063-44c7-aa21-ebed1e8c221b",\n    "accepted-language": "",\n    "content-length": 152,\n    "host": "api.stg.move.mil:443",\n    "method": "POST",\n    "protocol-version": "HTTP/1.1",\n    "referer": "",\n    "source": "172.20.35.232:45378",\n    "url": "/prime/v1/payment-requests",\n    "user-agent": "Go-http-client/1.1",\n    "protocol": "https",\n    "headers": 5,\n    "client-cert-id": "4fea0eb1-0009-47a8-98f4-0a102ee53a4f",\n    "duration": 0.614004182,\n    "resp-size-bytes": 133,\n    "resp-status": 500\n  }\n]\n')),(0,i.kt)("h2",{id:"filters"},"Filters"),(0,i.kt)("p",null,"Tips on filtering down the JSON responses from the API. You can experiment with jq filter options by inputting the JSON into this tool (",(0,i.kt)("a",{parentName:"p",href:"https://jqplay.org/"},"https://jqplay.org/"),")"),(0,i.kt)("h3",{id:"print-only-mto"},"Print only MTO"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --insecure fetch-mto-updates | \\\n  jq 'map(select(.id == \"53d5128e-158b-49a6-b3b3-64648b17afaa\")) | .[0]'\n")),(0,i.kt)("h3",{id:"print-specific-mto-shipments-etag"},"Print specific MTO Shipment's eTag"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'prime-api-client --insecure fetch-mto-updates | \\\n  jq \'map(select(.id == "da3f34cc-fb94-4e0b-1c90-ba3333cb7791")) | .[0] | .mtoShipments | map(select(.id == "b4148fad-acc6-4065-b387-90d05a702a24")) | .[0] | .eTag\'\n')),(0,i.kt)("h3",{id:"print-the-most-recent-mto-based-on-updatedat"},"Print the most recent MTO based on .updatedAt"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"prime-api-client --cac --hostname api.stg.move.mil --port 443 fetch-mto-updates | jq 'sort_by(.updatedAt) | .[-1]'\n")),(0,i.kt)("h3",{id:"print-the-mto-with-a-certain-movecode"},"Print the MTO with a certain moveCode"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"prime-api-client --cac --hostname api.stg.move.mil --port 443 fetch-mto-updates | jq 'map(select(.moveCode == \"9YGVRV\")) | .[0]'\n")),(0,i.kt)("h3",{id:"list-all-of-the-mto-service-items-for-a-shipment"},"List all of the MTO service items for a shipment"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'prime-api-client --insecure fetch-mto-updates | jq \'map(select(.id == "9a5cd4ba-f1b4-4fbe-8469-0ba245c3ec95")) | .[0] | .mtoServiceItems | map(select(.mtoShipmentID == "a6445307-2012-4e8f-9af3-b5166d8f051d")) \'\n')),(0,i.kt)("h3",{id:"generate-pr-payload-from-mto-id-and-shipment-id-with-certain-service-codes"},"Generate PR payload from MTO ID and Shipment ID with certain service codes"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'prime-api-client --insecure fetch-mto-updates | jq \'map(select(.id == "9a5cd4ba-f1b4-4fbe-8469-0ba245c3ec95")) | .[0] | .mtoServiceItems | map(select((.mtoShipmentID == "a6445307-2012-4e8f-9af3-b5166d8f051d") and .reServiceCode == "FSC" or .reService == "DLH" or .reServiceCode == "DOP" or .reServiceCode == "DPK" or .reServiceCode == "DUPK" ) ) | { body: { isFinal: false, moveTaskOrderID: "9a5cd4ba-f1b4-4fbe-8469-0ba245c3ec95", serviceItems: map({ id: .id }) } }\'\n')))}d.isMDXComponent=!0}}]);