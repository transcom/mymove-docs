"use strict";(self.webpackChunkmymove_docs=self.webpackChunkmymove_docs||[]).push([[8323],{51509:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var o=n(87462),r=(n(67294),n(3905));n(8209);const a={sidebar_position:9},i="How we use react-router",s={unversionedId:"frontend/guides/how-we-use-react-router",id:"frontend/guides/how-we-use-react-router",title:"How we use react-router",description:"The implementation of routes and navigation in MilMove using react-router has led to the development of several common code and testing patterns. This document's purpose is to provide an overview and examples of the most frequently employed techniques and patterns within MilMove. For more on react-router functionality, refer to the latest react-router documentation.",source:"@site/docs/frontend/guides/how-we-use-react-router.md",sourceDirName:"frontend/guides",slug:"/frontend/guides/how-we-use-react-router",permalink:"/mymove-docs/docs/frontend/guides/how-we-use-react-router",draft:!1,editUrl:"https://github.com/transcom/mymove-docs/edit/main/docs/frontend/guides/how-we-use-react-router.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9},sidebar:"frontendSidebar",previous:{title:"React forms using Formik",permalink:"/mymove-docs/docs/frontend/guides/react-forms-using-formik"},next:{title:"How to Track New Events in Move History",permalink:"/mymove-docs/docs/frontend/guides/how-to-add-move-history-events"}},p={},d=[{value:"Navigate",id:"navigate",level:2},{value:"Links",id:"links",level:2},{value:"URL Parameters (Params)",id:"url-parameters-params",level:2},{value:"Routes",id:"routes",level:2},{value:"Testing and Storybook",id:"testing-and-storybook",level:2},{value:"Routing Test Utilities",id:"routing-test-utilities",level:3},{value:"Props and Function Arguments",id:"props-and-function-arguments",level:4},{value:"<code>renderWithRouter</code>",id:"renderwithrouter",level:4},{value:"<code>MockRouterProvider</code>",id:"mockrouterprovider",level:4},{value:"Additional Providers",id:"additional-providers",level:3}],u={toc:d},l="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(l,(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-we-use-react-router"},"How we use ",(0,r.kt)("inlineCode",{parentName:"h1"},"react-router")),(0,r.kt)("p",null,"The implementation of routes and navigation in MilMove using ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router")," has led to the development of several common code and testing patterns. This document's purpose is to provide an overview and examples of the most frequently employed techniques and patterns within MilMove. For more on ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router")," functionality, refer to the latest ",(0,r.kt)("a",{parentName:"p",href:"https://reactrouter.com/en/main/start/overview"},"react-router documentation"),"."),(0,r.kt)("h2",{id:"navigate"},"Navigate"),(0,r.kt)("p",null,"The primary method for redirecting to a new URL using ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router")," is through the ",(0,r.kt)("inlineCode",{parentName:"p"},"Navigate")," function. This function serves as a replacement for ",(0,r.kt)("inlineCode",{parentName:"p"},"history.push()"),". It can be ",(0,r.kt)("a",{parentName:"p",href:"https://reactrouter.com/en/main/hooks/use-navigate"},"invoked as a function")," or utilized as a ",(0,r.kt)("a",{parentName:"p",href:"https://reactrouter.com/en/main/components/navigate"},"component-based version")," in class components where hooks are not available. One important consideration with ",(0,r.kt)("inlineCode",{parentName:"p"},"Navigate")," is that if the path does not start with a leading slash, it is resolved relative to the parent route."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"import { useNavigate } from 'react-router-dom';\n\nconst navigate = useNavigate();\n\n// Root path (starts with '/')\nnavigate('/absolute/path/to/page');\n\n// No leading slash, path is relative\nnavigate('relative/path'); // go to current URL + relative/path\n\n// Go back\nnavigate(-1);\n")),(0,r.kt)("h2",{id:"links"},"Links"),(0,r.kt)("p",null,"Links (and ",(0,r.kt)("a",{parentName:"p",href:"https://reactrouter.com/en/main/components/nav-link"},"NavLinks"),") are also commonly used in MilMove to navigate between pages. Similar to ",(0,r.kt)("inlineCode",{parentName:"p"},"Navigate"),", links can employ relative routing when the path lacks a leading slash. The react-router documentation describes this well:"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},'"A relative\xa0',(0,r.kt)("inlineCode",{parentName:"p"},"<Link to>"),"\xa0value (that does not begin with\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"/"),") resolves relative to the parent route, which means that it builds upon the URL path that was matched by the route that rendered that\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"<Link>"),". It may contain\xa0",(0,r.kt)("inlineCode",{parentName:"p"},".."),"\xa0to link to routes further up the hierarchy. In these cases,\xa0",(0,r.kt)("inlineCode",{parentName:"p"},".."),"\xa0works exactly like the command-line\xa0",(0,r.kt)("inlineCode",{parentName:"p"},"cd"),"\xa0function; each\xa0",(0,r.kt)("inlineCode",{parentName:"p"},".."),'\xa0removes one segment of the parent path."')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'import { Link } from \'react-router-dom\';\n\n// Root path (starts with \'/\')\n<Link to="/absolute/path/to/page" />\n\n// relative path\n<Link to="relative/path" />\n\n// remove one segmet of parent path, then relative path\n<Link to="../relative/path" relative="path"/>\n')),(0,r.kt)("h2",{id:"url-parameters-params"},"URL Parameters (Params)"),(0,r.kt)("p",null,"URL parameters can be accessed using the ",(0,r.kt)("a",{parentName:"p",href:"https://reactrouter.com/en/main/hooks/use-params"},(0,r.kt)("inlineCode",{parentName:"a"},"useParams()"))," hook."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"import { useParams } from 'react-router-dom';\n\n// On a route with path something like: /moves/:moveCode/details\nconst { moveCode } = useParams();\n")),(0,r.kt)("h2",{id:"routes"},"Routes"),(0,r.kt)("p",null,"In ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router")," version 6, the ",(0,r.kt)("a",{parentName:"p",href:"https://reactrouter.com/en/main/upgrading/v5#upgrade-all-switch-elements-to-routes"},(0,r.kt)("inlineCode",{parentName:"a"},"<Switch>")," component was replaced with the ",(0,r.kt)("inlineCode",{parentName:"a"},"<Routes>")," component"),". The most significant consequence of this change is that all children of the ",(0,r.kt)("inlineCode",{parentName:"p"},"<Routes>")," component must be pure ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router")," ",(0,r.kt)("inlineCode",{parentName:"p"},"<Route>")," components. Previously, we employed customized route components such as ",(0,r.kt)("inlineCode",{parentName:"p"},"<PrivateRoute>"),", which handled tasks like permission checks and displaying 'Forbidden' pages. This functionality has been refactored, and we now exclusively use pure ",(0,r.kt)("inlineCode",{parentName:"p"},"<Route>")," components. For more details, refer to the informative guide on ",(0,r.kt)("a",{parentName:"p",href:"https://gist.github.com/mjackson/d54b40a094277b7afdd6b81f51a0393f"},"composing ",(0,r.kt)("inlineCode",{parentName:"a"},"<Route>")," in react-router v6"),"."),(0,r.kt)("h2",{id:"testing-and-storybook"},"Testing and Storybook"),(0,r.kt)("p",null,"When rendering components that depend on ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router")," functionality, an error may occur (",(0,r.kt)("inlineCode",{parentName:"p"},"... may be used only in the context of a <Router> component"),") due to the absence of a ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router")," setup, as would be present in the application. This scenario is quite common and we have testing utilities to aid in setting up ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router")," (and other providers) for isolated component testing or Storybook."),(0,r.kt)("p",null,"These utility functions and components are locate in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/transcom/mymove/blob/main/src/testUtils.jsx"},"src/testUtils.jsx"),"."),(0,r.kt)("h3",{id:"routing-test-utilities"},"Routing Test Utilities"),(0,r.kt)("p",null,"If you only require a mocked ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router"),", you can employ the ",(0,r.kt)("inlineCode",{parentName:"p"},"renderWithRouter")," function, the ",(0,r.kt)("inlineCode",{parentName:"p"},"MockRouterProvider")," component, or the ",(0,r.kt)("inlineCode",{parentName:"p"},"renderWithRouterProp")," function for class components that use a ",(0,r.kt)("inlineCode",{parentName:"p"},"router")," prop. See ",(0,r.kt)("a",{parentName:"p",href:"#additional-providers"},"Additional Providers")," below for including additional providers."),(0,r.kt)("h4",{id:"props-and-function-arguments"},"Props and Function Arguments"),(0,r.kt)("p",null,"The props and arguments for these test utilities have undergone slight changes from our previous (similar) testing utilities. All props are optional and come with reasonable defaults. Therefore, provide them only when specific routing is necessary for the component. The primary props required for customizing routing are ",(0,r.kt)("inlineCode",{parentName:"p"},"path")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"params"),". The ",(0,r.kt)("inlineCode",{parentName:"p"},"path")," represents a ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router")," string ",(0,r.kt)("a",{parentName:"p",href:"https://reactrouter.com/en/main/route/route#path"},"path"),", which should typically be sourced from ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/transcom/mymove/blob/main/src/constants/routes.js"},"constants/routes.js"),". The ",(0,r.kt)("inlineCode",{parentName:"p"},"params")," correspond to the values for ",(0,r.kt)("a",{parentName:"p",href:"https://reactrouter.com/en/main/route/route#dynamic-segments"},"dynamic segments")," within the ",(0,r.kt)("inlineCode",{parentName:"p"},"path")," (segments starting with a colon). These two values ensure the proper execution of routing functionality and hooks like ",(0,r.kt)("inlineCode",{parentName:"p"},"useParams")," without requiring individual mocks, as was previously needed with our testing utilities."),(0,r.kt)("h4",{id:"renderwithrouter"},(0,r.kt)("inlineCode",{parentName:"h4"},"renderWithRouter")),(0,r.kt)("p",null,"This function is used to render a component with React Testing Library (RTL) and set up ",(0,r.kt)("inlineCode",{parentName:"p"},"react-router"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"import { renderWithRouter } from 'testUtils';\n\nconst routingConfig = {\n  path: customerRoutes.SHIPMENT_CREATE_PATH, // /moves/:moveId/new-shipment\n  params: { moveId: '976d1b02-afee-4e6e-9fe4-a18ced45807e' },\n};\n\nrenderWithRouter(<MtoShipmentForm />, routingConfig);\n")),(0,r.kt)("h4",{id:"mockrouterprovider"},(0,r.kt)("inlineCode",{parentName:"h4"},"MockRouterProvider")),(0,r.kt)("p",null,"Used when you need a routing provider setup but do not want to render with ",(0,r.kt)("a",{parentName:"p",href:"https://testing-library.com/docs/react-testing-library/intro/"},"RTL"),". Common uses include storybook and enzyme testing."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"import { MockRouterProvider } from 'testUtils';\n\n// Enzyme mount the QAE Report Header componenr with react router setup\nconst wrapper = mount(\n  <MockRouterProvider\n    path={qaeCSRRoutes.BASE_EVALUATION_REPORT_PATH}\n    params={{ moveCode: 'AMDORD', reportId: 'abc123' }}\n  >\n    <QaeReportHeader />\n  </MockRouterProvider>,\n);\n")),(0,r.kt)("h3",{id:"additional-providers"},"Additional Providers"),(0,r.kt)("p",null,"In addition to react-router, there are three other providers frequently required for rendering components in isolation: ",(0,r.kt)("inlineCode",{parentName:"p"},"react-query"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"permissions"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"redux"),". Similar to the routing provider utilities, we offer utility functions and components that set up and include all these providers. The most commonly used utilities are ",(0,r.kt)("inlineCode",{parentName:"p"},"renderWithProviders")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"MockProviders"),", which mirror the use cases of the routing-only utilities but include all other providers as well."))}m.isMDXComponent=!0}}]);